<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ุงูุซุงูููุฉ ุงูุนุงูุฉ - ุงูุดุนุจุฉ ุงูุฃุฏุจูุฉ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="../css/style.css">
  <script src="../js/auth.js"></script>
  <script src="../js/lessons.js"></script>
</head>
<body class="font-arabic bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
  <!-- Navigation -->
  <nav class="bg-white shadow-lg">
    <div class="max-w-7xl mx-auto px-4">
      <div class="flex justify-between items-center py-4">
        <div class="flex items-center space-x-4 rtl:space-x-reverse">
          <img src="../images/default_user.png" alt="Logo" class="h-8 w-8">
          <h1 class="text-xl font-bold text-gray-800">ุงูุซุงูููุฉ ุงูุนุงูุฉ - ุงูุฃุฏุจู</h1>
        </div>
        <div class="flex items-center space-x-4 rtl:space-x-reverse">
          <div class="relative">
            <button id="teacherModeToggle" class="flex items-center space-x-2 rtl:space-x-reverse px-3 py-2 rounded-lg bg-gradient-to-r from-blue-500 to-purple-600 text-white font-medium hover:shadow-lg transition-all">
              <span id="modeText">๐ ูุถุน ุงููุฏุฑุณ</span>
              <span id="loadingIndicator" class="hidden animate-spin">โ๏ธ</span>
            </button>
          </div>
          <a href="../pages/profile.html" class="text-gray-600 hover:text-gray-800">ุงูููู ุงูุดุฎุตู</a>
          <a href="../index.html" class="text-red-600 hover:text-red-800" onclick="logout()">ุชุณุฌูู ุงูุฎุฑูุฌ</a>
        </div>
      </div>
    </div>
  </nav>

  <div class="max-w-7xl mx-auto px-4 py-8">
    <!-- Back Button -->
    <div class="mb-6">
      <button onclick="backToGrade()" class="flex items-center space-x-2 rtl:space-x-reverse text-blue-600 hover:text-blue-800 font-medium">
        <svg class="w-5 h-5 rtl:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
        <span>ุงูุนูุฏุฉ ููุตููู</span>
      </button>
    </div>

    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
      <!-- Lessons Section -->
      <div class="bg-white rounded-lg shadow-md p-6">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center space-x-3 rtl:space-x-reverse">
            <div class="bg-blue-100 p-2 rounded-lg">
              <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">ุงูุฏุฑูุณ</h2>
          </div>
        </div>
        <div id="lessonsContainer" class="space-y-3"></div>
      </div>

      <!-- Schedule Section -->
      <div class="bg-white rounded-lg shadow-md p-6">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center space-x-3 rtl:space-x-reverse">
            <div class="bg-green-100 p-2 rounded-lg">
              <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">ุงูุฌุฏูู ุงูุฏุฑุงุณู</h2>
          </div>
          <div id="scheduleTeacherTools" class="hidden">
            <button onclick="openAddScheduleModal()" class="bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded text-sm">ุฅุถุงูุฉ</button>
          </div>
        </div>
        <div id="scheduleContainer" class="space-y-3"></div>
      </div>

      <!-- Homework Section -->
      <div class="bg-white rounded-lg shadow-md p-6">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center space-x-3 rtl:space-x-reverse">
            <div class="bg-orange-100 p-2 rounded-lg">
              <svg class="w-6 h-6 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">ุงููุงุฌุจุงุช</h2>
          </div>
          <div id="homeworkTeacherTools" class="hidden">
            <button onclick="openAddHomeworkModal()" class="bg-orange-500 hover:bg-orange-600 text-white px-3 py-1 rounded text-sm">ุฅุถุงูุฉ</button>
          </div>
        </div>
        <div id="homeworkContainer" class="space-y-3"></div>
      </div>

      <!-- Materials Section -->
      <div class="bg-white rounded-lg shadow-md p-6">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center space-x-3 rtl:space-x-reverse">
            <div class="bg-purple-100 p-2 rounded-lg">
              <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">ุงูููุงุฏ ุงูุฏุฑุงุณูุฉ</h2>
          </div>
          <div id="materialsTeacherTools" class="hidden">
            <button onclick="openAddMaterialModal()" class="bg-purple-500 hover:bg-purple-600 text-white px-3 py-1 rounded text-sm">ุฅุถุงูุฉ</button>
          </div>
        </div>
        <div id="materialsContainer" class="space-y-3"></div>
      </div>

      <!-- Quizzes Section -->
      <div class="bg-white rounded-lg shadow-md p-6">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center space-x-3 rtl:space-x-reverse">
            <div class="bg-red-100 p-2 rounded-lg">
              <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-800">ุงููููุฒุงุช</h2>
          </div>
          <div id="quizzesTeacherTools" class="hidden">
            <button onclick="openAddQuizModal()" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm">ุฅุถุงูุฉ</button>
          </div>
        </div>
        <div id="quizzesContainer" class="space-y-3"></div>
      </div>
    </div>
  </div>

  <!-- Notification -->
  <div id="notification" class="fixed top-4 left-1/2 transform -translate-x-1/2 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg hidden z-50">
    <span id="notificationMessage"></span>
  </div>

  <!-- Schedule Management Modal -->
  <div id="scheduleModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
      <div class="flex justify-between items-center mb-4">
        <h3 id="scheduleModalTitle" class="text-lg font-bold text-gray-800">ุฅุถุงูุฉ ุฌุฏูู ุฏุฑุงุณู</h3>
        <button onclick="closeScheduleModal()" class="text-gray-500 hover:text-gray-700">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <form id="scheduleForm" onsubmit="saveSchedule(event)">
        <div class="grid grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">ุงูููู</label>
            <select id="scheduleDay" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
              <option value="">ุงุฎุชุฑ ุงูููู</option>
              <option value="ุงูุฃุญุฏ">ุงูุฃุญุฏ</option>
              <option value="ุงูุงุซููู">ุงูุงุซููู</option>
              <option value="ุงูุซูุงุซุงุก">ุงูุซูุงุซุงุก</option>
              <option value="ุงูุฃุฑุจุนุงุก">ุงูุฃุฑุจุนุงุก</option>
              <option value="ุงูุฎููุณ">ุงูุฎููุณ</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">ุงููุงุฏุฉ</label>
            <input type="text" id="scheduleSubject" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4 mb-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">ูู ุงูุณุงุนุฉ</label>
            <input type="time" id="scheduleTimeStart" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">ุฅูู ุงูุณุงุนุฉ</label>
            <input type="time" id="scheduleTimeEnd" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
          </div>
        </div>
        <div class="flex gap-3">
          <button type="submit" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-md transition-colors">ุญูุธ</button>
          <button type="button" onclick="closeScheduleModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 px-4 rounded-md transition-colors">ุฅูุบุงุก</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add Homework Modal -->
  <div id="addHomeworkModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
      <div class="flex justify-between items-center mb-4">
        <h3 id="homeworkModalTitle" class="text-lg font-bold text-gray-800">ุฅุถุงูุฉ ูุงุฌุจ</h3>
        <button onclick="closeAddHomeworkModal()" class="text-gray-500 hover:text-gray-700">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <form id="homeworkForm" onsubmit="saveHomework(event)">
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1">ุงููุงุฏุฉ</label>
          <input type="text" id="homeworkSubject" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1">ูุตู ุงููุงุฌุจ</label>
          <textarea id="homeworkDescription" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" rows="3"></textarea>
        </div>
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 mb-1">ุชุงุฑูุฎ ุงูุชุณููู</label>
          <input type="date" id="homeworkDueDate" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
        </div>
        <div class="flex gap-3">
          <button type="submit" class="flex-1 bg-orange-500 hover:bg-orange-600 text-white py-2 px-4 rounded-md transition-colors">ุญูุธ</button>
          <button type="button" onclick="closeAddHomeworkModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 px-4 rounded-md transition-colors">ุฅูุบุงุก</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add Material Modal -->
  <div id="addMaterialModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-bold text-gray-800">ุฅุถุงูุฉ ูุงุฏุฉ ุฏุฑุงุณูุฉ</h3>
        <button onclick="closeAddMaterialModal()" class="text-gray-500 hover:text-gray-700">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <form id="materialForm" onsubmit="saveMaterial(event)">
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1">ุนููุงู ุงููุงุฏุฉ</label>
          <input type="text" id="materialTitle" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1">ุงููุตู</label>
          <textarea id="materialDescription" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" rows="3"></textarea>
        </div>
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 mb-1">ุฑุงุจุท ุงููุงุฏุฉ</label>
          <input type="url" id="materialLink" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://...">
        </div>
        <div class="flex gap-3">
          <button type="submit" class="flex-1 bg-purple-500 hover:bg-purple-600 text-white py-2 px-4 rounded-md transition-colors">ุญูุธ</button>
          <button type="button" onclick="closeAddMaterialModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 px-4 rounded-md transition-colors">ุฅูุบุงุก</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add Quiz Modal -->
  <div id="addQuizModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-bold text-gray-800">ุฅุถุงูุฉ ูููุฒ</h3>
        <button onclick="closeAddQuizModal()" class="text-gray-500 hover:text-gray-700">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <form id="quizForm" onsubmit="saveQuiz(event)">
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1">ุนููุงู ุงููููุฒ</label>
          <input type="text" id="quizTitle" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1">ุงููุตู</label>
          <textarea id="quizDescription" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" rows="3"></textarea>
        </div>
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 mb-1">ุงูุญุงูุฉ</label>
          <select id="quizStatus" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            <option value="ูุชุงุญ">ูุชุงุญ</option>
            <option value="ุบูุฑ ูุชุงุญ">ุบูุฑ ูุชุงุญ</option>
            <option value="ููุชูู">ููุชูู</option>
          </select>
        </div>
        <div class="flex gap-3">
          <button type="submit" class="flex-1 bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-md transition-colors">ุญูุธ</button>
          <button type="button" onclick="closeAddQuizModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 px-4 rounded-md transition-colors">ุฅูุบุงุก</button>
        </div>
      </form>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    // Global state
    let isTeacherMode = false;
    let editingScheduleId = null;
    let editingHomeworkId = null;
    
    // Data structures
    const lessons = [
      { id: 1, title: "ุงูุชุงุฑูุฎ ุงูุฅุณูุงูู", description: "ุฏุฑุงุณุฉ ุงูุญุถุงุฑุฉ ุงูุฅุณูุงููุฉ ูุชุทูุฑูุง", status: "ูุชุงุญ" },
      { id: 2, title: "ุงูุฃุฏุจ ุงูุนุฑุจู", description: "ุงูุดุนุฑ ูุงููุซุฑ ูู ุงูุนุตุฑ ุงูุนุจุงุณู", status: "ูุชุงุญ" },
      { id: 3, title: "ุงูุฌุบุฑุงููุง", description: "ุฌุบุฑุงููุง ุงููุทู ุงูุนุฑุจู", status: "ูุชุงุญ" },
      { id: 4, title: "ุนูู ุงูููุณ", description: "ูุจุงุฏุฆ ุนูู ุงูููุณ ุงูุชุฑุจูู", status: "ูุชุงุญ" }
    ];

    // Utility Functions
    function showNotification(message, type = 'success') {
      const notification = document.getElementById('notification');
      const notificationMessage = document.getElementById('notificationMessage');
      
      notificationMessage.textContent = message;
      notification.className = `fixed top-4 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg shadow-lg z-50 ${
        type === 'success' ? 'bg-green-500' : 'bg-red-500'
      } text-white`;
      
      notification.classList.remove('hidden');
      setTimeout(() => {
        notification.classList.add('hidden');
      }, 3000);
    }

    function backToGrade() {
      window.location.href = '../index.html';
    }

    function isValidYouTubeUrl(url) {
      const youtubeRegex = /^(https?:\/\/)?(www\.)?(youtube\.com\/(watch\?v=|embed\/)|youtu\.be\/).+/;
      return youtubeRegex.test(url);
    }

    // Teacher Mode Functions
    function toggleTeacherMode() {
      const modeText = document.getElementById('modeText');
      const indicator = document.getElementById('loadingIndicator');
      
      indicator.classList.remove('hidden');
      
      setTimeout(() => {
        isTeacherMode = !isTeacherMode;
        if (isTeacherMode) {
          modeText.textContent = '๐ฉโ๐ ูุถุน ุงูุทุงูุจ';
          indicator.classList.add('hidden');
          showTeacherTools();
        } else {
          modeText.textContent = '๐ ูุถุน ุงููุฏุฑุณ';
          indicator.classList.add('hidden');
          hideTeacherTools();
        }
      }, 1000);
    }

    function showTeacherTools() {
      document.getElementById('scheduleTeacherTools').classList.remove('hidden');
      document.getElementById('homeworkTeacherTools').classList.remove('hidden');
      document.getElementById('materialsTeacherTools').classList.remove('hidden');
      document.getElementById('quizzesTeacherTools').classList.remove('hidden');
    }

    function hideTeacherTools() {
      document.getElementById('scheduleTeacherTools').classList.add('hidden');
      document.getElementById('homeworkTeacherTools').classList.add('hidden');
      document.getElementById('materialsTeacherTools').classList.add('hidden');
      document.getElementById('quizzesTeacherTools').classList.add('hidden');
    }

    // Rendering Functions
    function renderAllContent() {
      renderLessons();
      renderSchedule();
      renderHomework();
      renderMaterials();
      renderQuizzes();
    }

    function renderLessons() {
      const container = document.getElementById('lessonsContainer');
      container.innerHTML = lessons.map(lesson => {
        const savedLink = localStorage.getItem(`lesson_${lesson.id}_link`);
        return `
          <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
            <h3 class="font-semibold text-gray-800 mb-2">${lesson.title}</h3>
            <p class="text-gray-600 text-sm mb-3">${lesson.description}</p>
            
            ${isTeacherMode ? `
              <div class="teacher-tools mb-3 p-3 bg-blue-50 rounded border">
                <div class="flex items-center space-x-2 rtl:space-x-reverse mb-2">
                  <input type="url" id="link_${lesson.id}" placeholder="ุฑุงุจุท ุงูููุชููุจ" 
                    value="${savedLink || ''}"
                    class="flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
                  />
                  <button onclick="saveLink(${lesson.id})" 
                    class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm">
                    ุญูุธ
                  </button>
                </div>
                ${savedLink ? `
                  <button onclick="removeLink(${lesson.id})" 
                    class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs">
                    ุญุฐู ุงูุฑุงุจุท
                  </button>
                ` : ''}
              </div>
            ` : ''}
            
            <div class="flex space-x-2 rtl:space-x-reverse">
              ${savedLink ? `
                <button onclick="watchLesson('${savedLink}')" 
                  class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded text-sm flex items-center space-x-1 rtl:space-x-reverse">
                  <span>ูุดุงูุฏุฉ</span>
                  <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"/>
                    <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"/>
                  </svg>
                </button>
              ` : ''}
              <button onclick="openLessonDetail(${lesson.id})" 
                class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm">
                ุงูุชูุงุตูู
              </button>
            </div>
          </div>
        `;
      }).join('');
    }

    function renderSchedule() {
      const scheduleItems = JSON.parse(localStorage.getItem('scheduleItems_grade2art') || '[]');
      const container = document.getElementById('scheduleContainer');
      
      if (scheduleItems.length === 0) {
        container.innerHTML = '<p class="text-gray-500 text-center">ูุง ุชูุฌุฏ ุฌุฏุงูู ุฏุฑุงุณูุฉ</p>';
        return;
      }

      container.innerHTML = scheduleItems.map((item, index) => `
        <div class="border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow">
          <div class="flex justify-between items-start mb-2">
            <h4 class="font-semibold text-gray-800">${item.subject}</h4>
            ${isTeacherMode ? `
              <div class="flex space-x-1 rtl:space-x-reverse">
                <button onclick="editScheduleItem(${index})" 
                  class="text-blue-500 hover:text-blue-700 p-1">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                  </svg>
                </button>
                <button onclick="deleteScheduleItem(${index})" 
                  class="text-red-500 hover:text-red-700 p-1">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                  </svg>
                </button>
              </div>
            ` : ''}
          </div>
          <p class="text-sm text-gray-600">${item.day}</p>
          <p class="text-sm text-gray-500">${item.startTime} - ${item.endTime}</p>
        </div>
      `).join('');
    }

    function renderHomework() {
      const homeworkItems = JSON.parse(localStorage.getItem('homeworkItems_grade2art') || '[]');
      const container = document.getElementById('homeworkContainer');
      
      if (homeworkItems.length === 0) {
        container.innerHTML = '<p class="text-gray-500 text-center">ูุง ุชูุฌุฏ ูุงุฌุจุงุช</p>';
        return;
      }

      container.innerHTML = homeworkItems.map((item, index) => {
        const today = new Date();
        const due = new Date(item.dueDate);
        const diffDays = Math.ceil((due - today) / (1000 * 60 * 60 * 24));
        
        let statusClass = 'bg-red-100 text-red-800';
        let statusText = 'ูุชุฃุฎุฑ';
        
        if (diffDays === 1) {
          statusClass = 'bg-yellow-100 text-yellow-800';
          statusText = 'ุบุฏุงู';
        } else if (diffDays <= 7 && diffDays > 1) {
          statusClass = 'bg-blue-100 text-blue-800';
          statusText = 'ูุฐุง ุงูุฃุณุจูุน';
        } else if (diffDays > 7) {
          statusClass = 'bg-green-100 text-green-800';
          statusText = 'ุงูุฃุณุจูุน ุงููุงุฏู';
        }

        return `
          <div class="border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-semibold text-gray-800">${item.subject}</h4>
              ${isTeacherMode ? `
                <div class="flex space-x-1 rtl:space-x-reverse">
                  <button onclick="editHomeworkItem(${index})" 
                    class="text-blue-500 hover:text-blue-700 p-1">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                    </svg>
                  </button>
                  <button onclick="deleteHomeworkItem(${index})" 
                    class="text-red-500 hover:text-red-700 p-1">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                    </svg>
                  </button>
                </div>
              ` : ''}
            </div>
            <p class="text-sm text-gray-600 mb-2">${item.description}</p>
            <div class="flex justify-between items-center">
              <span class="text-xs text-gray-500">ุชุณููู: ${item.dueDate}</span>
              <span class="px-2 py-1 text-xs rounded-full ${statusClass}">${statusText}</span>
            </div>
          </div>
        `;
      }).join('');
    }

    function renderMaterials() {
      const materials = JSON.parse(localStorage.getItem('materials_grade2art') || '[]');
      const container = document.getElementById('materialsContainer');
      
      if (materials.length === 0) {
        container.innerHTML = '<p class="text-gray-500 text-center">ูุง ุชูุฌุฏ ููุงุฏ ุฏุฑุงุณูุฉ</p>';
        return;
      }

      container.innerHTML = materials.map((material, index) => `
        <div class="border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow">
          <div class="flex justify-between items-start mb-2">
            <h4 class="font-semibold text-gray-800">${material.title}</h4>
            ${isTeacherMode ? `
              <div class="flex space-x-1 rtl:space-x-reverse">
                <button onclick="editMaterialItem(${index})" 
                  class="text-blue-500 hover:text-blue-700 p-1">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                  </svg>
                </button>
                <button onclick="deleteMaterialItem(${index})" 
                  class="text-red-500 hover:text-red-700 p-1">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                  </svg>
                </button>
              </div>
            ` : ''}
          </div>
          <p class="text-sm text-gray-600 mb-3">${material.description}</p>
          <div class="space-y-2">
            ${material.files.map(file => `
              <button onclick="downloadFile('${file.link}')" 
                class="w-full text-right bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded text-sm text-blue-600 hover:text-blue-800 transition-colors">
                ๐ ${file.name}
              </button>
            `).join('')}
          </div>
        </div>
      `).join('');
    }

    function renderQuizzes() {
      const quizzes = JSON.parse(localStorage.getItem('quizzes_grade2art') || '[]');
      const container = document.getElementById('quizzesContainer');
      
      if (quizzes.length === 0) {
        container.innerHTML = '<p class="text-gray-500 text-center">ูุง ุชูุฌุฏ ูููุฒุงุช</p>';
        return;
      }

      container.innerHTML = quizzes.map((quiz, index) => {
        let statusClass = 'bg-green-100 text-green-800';
        if (quiz.status === 'ุบูุฑ ูุชุงุญ') statusClass = 'bg-red-100 text-red-800';
        else if (quiz.status === 'ููุชูู') statusClass = 'bg-gray-100 text-gray-800';

        return `
          <div class="border border-gray-200 rounded-lg p-3 hover:shadow-md transition-shadow">
            <div class="flex justify-between items-start mb-2">
              <h4 class="font-semibold text-gray-800">${quiz.title}</h4>
              ${isTeacherMode ? `
                <div class="flex space-x-1 rtl:space-x-reverse">
                  <button onclick="editQuizItem(${index})" 
                    class="text-blue-500 hover:text-blue-700 p-1">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                    </svg>
                  </button>
                  <button onclick="deleteQuizItem(${index})" 
                    class="text-red-500 hover:text-red-700 p-1">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                    </svg>
                  </button>
                </div>
              ` : ''}
            </div>
            <p class="text-sm text-gray-600 mb-2">${quiz.description}</p>
            <div class="flex justify-between items-center">
              <span class="px-2 py-1 text-xs rounded-full ${statusClass}">${quiz.status}</span>
              ${quiz.status === 'ูุชุงุญ' ? `
                <button onclick="startQuiz(${index})" 
                  class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm">
                  ุงุจุฏุฃ ุงููููุฒ
                </button>
              ` : ''}
            </div>
          </div>
        `;
      }).join('');
    }

    // Lesson Functions
    function saveLink(lessonId) {
      const linkInput = document.getElementById(`link_${lessonId}`);
      const link = linkInput.value.trim();
      
      if (link && isValidYouTubeUrl(link)) {
        localStorage.setItem(`lesson_${lessonId}_link`, link);
        renderLessons();
        showNotification('ุชู ุญูุธ ุงูุฑุงุจุท ุจูุฌุงุญ! โ', 'success');
      } else if (link) {
        showNotification('ูุฑุฌู ุฅุฏุฎุงู ุฑุงุจุท ููุชููุจ ุตุญูุญ', 'error');
      } else {
        showNotification('ูุฑุฌู ุฅุฏุฎุงู ุฑุงุจุท', 'error');
      }
    }

    function removeLink(lessonId) {
      if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูุฑุงุจุทุ')) {
        localStorage.removeItem(`lesson_${lessonId}_link`);
        renderLessons();
        showNotification('ุชู ุญุฐู ุงูุฑุงุจุท ุจูุฌุงุญ', 'success');
      }
    }

    function watchLesson(link) {
      if (link) {
        window.open(link, '_blank');
      }
    }

    function openLessonDetail(id) {
      window.location.href = `lesson.html?id=${encodeURIComponent(id)}`;
    }

    function downloadFile(link) {
      window.open(link, '_blank');
    }

    // Schedule Management Functions
    function openAddScheduleModal() {
      editingScheduleId = null;
      document.getElementById('scheduleModalTitle').textContent = 'ุฅุถุงูุฉ ุฌุฏูู ุฏุฑุงุณู';
      document.getElementById('scheduleForm').reset();
      document.getElementById('scheduleModal').classList.remove('hidden');
    }

    function closeScheduleModal() {
      document.getElementById('scheduleModal').classList.add('hidden');
      editingScheduleId = null;
    }

    function saveSchedule(event) {
      event.preventDefault();
      
      const day = document.getElementById('scheduleDay').value.trim();
      const subject = document.getElementById('scheduleSubject').value.trim();
      const startTime = document.getElementById('scheduleTimeStart').value;
      const endTime = document.getElementById('scheduleTimeEnd').value;
      
      if (!day || !subject || !startTime || !endTime) {
        showNotification('ูุฑุฌู ููุก ุฌููุน ุงูุญููู', 'error');
        return;
      }
      
      const scheduleItems = JSON.parse(localStorage.getItem('scheduleItems_grade2art') || '[]');
      const newItem = { day, subject, startTime, endTime };
      
      if (editingScheduleId !== null) {
        scheduleItems[editingScheduleId] = newItem;
        showNotification('ุชู ุชุญุฏูุซ ุงูุฌุฏูู ุจูุฌุงุญ', 'success');
      } else {
        scheduleItems.push(newItem);
        showNotification('ุชูุช ุฅุถุงูุฉ ุงูุฌุฏูู ุจูุฌุงุญ', 'success');
      }
      
      localStorage.setItem('scheduleItems_grade2art', JSON.stringify(scheduleItems));
      renderSchedule();
      closeScheduleModal();
    }

    function editScheduleItem(index) {
      const scheduleItems = JSON.parse(localStorage.getItem('scheduleItems_grade2art') || '[]');
      const item = scheduleItems[index];
      
      editingScheduleId = index;
      document.getElementById('scheduleModalTitle').textContent = 'ุชุนุฏูู ุงูุฌุฏูู ุงูุฏุฑุงุณู';
      document.getElementById('scheduleDay').value = item.day;
      document.getElementById('scheduleSubject').value = item.subject;
      document.getElementById('scheduleTimeStart').value = item.startTime;
      document.getElementById('scheduleTimeEnd').value = item.endTime;
      document.getElementById('scheduleModal').classList.remove('hidden');
    }

    function deleteScheduleItem(index) {
      if (!confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูุนูุตุฑุ')) return;
      
      const scheduleItems = JSON.parse(localStorage.getItem('scheduleItems_grade2art') || '[]');
      scheduleItems.splice(index, 1);
      localStorage.setItem('scheduleItems_grade2art', JSON.stringify(scheduleItems));
      
      renderSchedule();
      showNotification('ุชู ุญุฐู ุงูุนูุตุฑ ุจูุฌุงุญ', 'success');
    }

    // Homework Management Functions
    function openAddHomeworkModal() {
      editingHomeworkId = null;
      document.getElementById('homeworkModalTitle').textContent = 'ุฅุถุงูุฉ ูุงุฌุจ';
      document.getElementById('homeworkForm').reset();
      document.getElementById('addHomeworkModal').classList.remove('hidden');
    }

    function closeAddHomeworkModal() {
      document.getElementById('addHomeworkModal').classList.add('hidden');
      editingHomeworkId = null;
    }

    function saveHomework(event) {
      event.preventDefault();
      
      const subject = document.getElementById('homeworkSubject').value.trim();
      const description = document.getElementById('homeworkDescription').value.trim();
      const dueDate = document.getElementById('homeworkDueDate').value;
      
      if (!subject || !description || !dueDate) {
        showNotification('ูุฑุฌู ููุก ุฌููุน ุงูุญููู', 'error');
        return;
      }
      
      const homeworkItems = JSON.parse(localStorage.getItem('homeworkItems_grade2art') || '[]');
      const newItem = { subject, description, dueDate };
      
      if (editingHomeworkId !== null) {
        homeworkItems[editingHomeworkId] = newItem;
        showNotification('ุชู ุชุญุฏูุซ ุงููุงุฌุจ ุจูุฌุงุญ', 'success');
      } else {
        homeworkItems.push(newItem);
        showNotification('ุชูุช ุฅุถุงูุฉ ุงููุงุฌุจ ุจูุฌุงุญ', 'success');
      }
      
      localStorage.setItem('homeworkItems_grade2art', JSON.stringify(homeworkItems));
      renderHomework();
      closeAddHomeworkModal();
    }

    function editHomeworkItem(index) {
      const homeworkItems = JSON.parse(localStorage.getItem('homeworkItems_grade2art') || '[]');
      const item = homeworkItems[index];
      
      editingHomeworkId = index;
      document.getElementById('homeworkModalTitle').textContent = 'ุชุนุฏูู ุงููุงุฌุจ';
      document.getElementById('homeworkSubject').value = item.subject;
      document.getElementById('homeworkDescription').value = item.description;
      document.getElementById('homeworkDueDate').value = item.dueDate;
      document.getElementById('addHomeworkModal').classList.remove('hidden');
    }

    function deleteHomeworkItem(index) {
      if (!confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงููุงุฌุจุ')) return;
      
      const homeworkItems = JSON.parse(localStorage.getItem('homeworkItems_grade2art') || '[]');
      homeworkItems.splice(index, 1);
      localStorage.setItem('homeworkItems_grade2art', JSON.stringify(homeworkItems));
      
      renderHomework();
      showNotification('ุชู ุญุฐู ุงููุงุฌุจ ุจูุฌุงุญ', 'success');
    }

    // Material Management Functions
    function openAddMaterialModal() {
      document.getElementById('materialForm').reset();
      document.getElementById('addMaterialModal').classList.remove('hidden');
    }

    function closeAddMaterialModal() {
      document.getElementById('addMaterialModal').classList.add('hidden');
    }

    function saveMaterial(event) {
      event.preventDefault();
      
      const title = document.getElementById('materialTitle').value.trim();
      const description = document.getElementById('materialDescription').value.trim();
      const link = document.getElementById('materialLink').value.trim();
      
      if (!title || !description || !link) {
        showNotification('ูุฑุฌู ููุก ุฌููุน ุงูุญููู', 'error');
        return;
      }
      
      const materials = JSON.parse(localStorage.getItem('materials_grade2art') || '[]');
      const fileName = title + '.pdf';
      
      materials.push({
        title,
        description,
        files: [{ name: fileName, link }]
      });
      
      localStorage.setItem('materials_grade2art', JSON.stringify(materials));
      renderMaterials();
      closeAddMaterialModal();
      showNotification('ุชูุช ุฅุถุงูุฉ ุงููุงุฏุฉ ุจูุฌุงุญ', 'success');
    }

    function editMaterialItem(index) {
      const materials = JSON.parse(localStorage.getItem('materials_grade2art') || '[]');
      const material = materials[index];
      
      document.getElementById('materialTitle').value = material.title;
      document.getElementById('materialDescription').value = material.description;
      document.getElementById('materialLink').value = material.files[0]?.link || '';
      document.getElementById('addMaterialModal').classList.remove('hidden');
      
      // Store editing index for save function
      window.editingMaterialIndex = index;
    }

    function deleteMaterialItem(index) {
      if (!confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐู ุงููุงุฏุฉุ')) return;
      
      const materials = JSON.parse(localStorage.getItem('materials_grade2art') || '[]');
      materials.splice(index, 1);
      localStorage.setItem('materials_grade2art', JSON.stringify(materials));
      
      renderMaterials();
      showNotification('ุชู ุญุฐู ุงููุงุฏุฉ ุจูุฌุงุญ', 'success');
    }

    // Quiz Management Functions
    function openAddQuizModal() {
      document.getElementById('quizForm').reset();
      document.getElementById('addQuizModal').classList.remove('hidden');
    }

    function closeAddQuizModal() {
      document.getElementById('addQuizModal').classList.add('hidden');
    }

    function saveQuiz(event) {
      event.preventDefault();
      
      const title = document.getElementById('quizTitle').value.trim();
      const description = document.getElementById('quizDescription').value.trim();
      const status = document.getElementById('quizStatus').value;
      
      if (!title || !description) {
        showNotification('ูุฑุฌู ููุก ุฌููุน ุงูุญููู', 'error');
        return;
      }
      
      const quizzes = JSON.parse(localStorage.getItem('quizzes_grade2art') || '[]');
      
      quizzes.push({ title, description, status });
      localStorage.setItem('quizzes_grade2art', JSON.stringify(quizzes));
      
      renderQuizzes();
      closeAddQuizModal();
      showNotification('ุชูุช ุฅุถุงูุฉ ุงููููุฒ ุจูุฌุงุญ', 'success');
    }

    function editQuizItem(index) {
      const quizzes = JSON.parse(localStorage.getItem('quizzes_grade2art') || '[]');
      const quiz = quizzes[index];
      
      document.getElementById('quizTitle').value = quiz.title;
      document.getElementById('quizDescription').value = quiz.description;
      document.getElementById('quizStatus').value = quiz.status;
      document.getElementById('addQuizModal').classList.remove('hidden');
      
      // Store editing index for save function
      window.editingQuizIndex = index;
    }

    function deleteQuizItem(index) {
      if (!confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงููููุฒุ')) return;
      
      const quizzes = JSON.parse(localStorage.getItem('quizzes_grade2art') || '[]');
      quizzes.splice(index, 1);
      localStorage.setItem('quizzes_grade2art', JSON.stringify(quizzes));
      
      renderQuizzes();
      showNotification('ุชู ุญุฐู ุงููููุฒ ุจูุฌุงุญ', 'success');
    }

    function startQuiz(index) {
      // ุชูุฌูู ุงูุทุงูุจ ูุตูุญุฉ ุญู ุงููููุฒ
      showNotification('ุณูุชู ุชุญูููู ูุตูุญุฉ ุงููููุฒ...', 'success');
      // window.location.href = `quiz.html?id=${index}`;
    }

    // Event Listeners
    document.addEventListener('DOMContentLoaded', function() {
      // Add teacher mode toggle event listener
      document.getElementById('teacherModeToggle').addEventListener('click', toggleTeacherMode);
      
      // Initial render
      renderAllContent();
    });
  </script>

  <!-- Teacher Mode Auto System -->
  <script src="../js/teacher-mode.js"></script>
</body>
</html>