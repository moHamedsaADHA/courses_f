<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…Ù†ØµØ© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</title>
  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Ù…ÙƒØªØ¨Ø© Ø§Ù„ØªØ§ÙŠØ¨Ù†Ø¬ -->
  <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
  <!-- Auth Utility Library (Ù…ÙˆØ­Ø¯) -->
  <script src="../js/auth.js"></script>

  <style>
    body {
      font-family: 'Cairo', sans-serif;
      transition: background 0.5s ease, color 0.5s ease;
    }
    .animated-bg {
      background: linear-gradient(270deg, #0f172a, #0f172a);
      background-size: 600% 600%;
      animation: gradientShift 18s ease infinite;
    }
    @keyframes gradientShift {
      0%   { background-position: 0% 50%; }
      50%  { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .profile-img {
      transition: all 0.5s ease;
    }
    .profile-img:hover {
      transform: scale(1.05);
      filter: drop-shadow(0 0 25px rgba(59,130,246,0.8));
    }
    .card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .card:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    }
    .modal {
      position: fixed; inset: 0;
      background: rgba(0,0,0,0.6);
      display: none; justify-content: center; align-items: center;
      z-index: 100;
    }
    .modal-content {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 2rem;
      width: 100%; max-width: 460px;
      color: white;
      transform: scale(0.7);
      opacity: 0;
      transition: all 0.3s ease;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    }
    .modal.show .modal-content {
      transform: scale(1);
      opacity: 1;
    }
    
    /* OTP Input Styling */
    .otp-input {
      background: rgba(255, 255, 255, 0.1) !important;
      border: 2px solid rgba(255, 255, 255, 0.2);
      color: white !important;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    .otp-input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
    }
    
    /* Form Input Styling */
    .modal input {
      background: rgba(255, 255, 255, 0.1) !important;
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
      color: white !important;
    }
    
    .modal select {
      background: white !important;
      color: #374151 !important;
      border: 1px solid #d1d5db;
      transition: all 0.3s ease;
    }
    
    .modal select option {
      background: white !important;
      color: #374151 !important;
      padding: 8px;
    }
    
    .modal select optgroup {
      font-weight: bold;
      padding: 4px;
    }
    
    .modal input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
    }
    
    .modal select:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
    }
    
    /* Button Styling */
    .modal button[type="submit"] {
      position: relative;
      overflow: hidden;
    }
    .modal button[type="submit"]:before {
      content: '';
      position: absolute;
      top: 0; left: -100%;
      width: 100%; height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s;
    }
    .modal button[type="submit"]:hover:before {
      left: 100%;
    }
    
    /* Loading Animation */
    .loading {
      position: relative;
    }
    .loading:after {
      content: '';
      position: absolute;
      right: 10px; top: 50%;
      transform: translateY(-50%);
      width: 16px; height: 16px;
      border: 2px solid rgba(255,255,255,0.3);
      border-top: 2px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: translateY(-50%) rotate(0deg); }
      100% { transform: translateY(-50%) rotate(360deg); }
    }
    
    /* Error and Success Messages */
    .error-message {
      background: linear-gradient(135deg, #ef4444, #dc2626);
      animation: slideInFromTop 0.3s ease;
    }
    .success-message {
      background: linear-gradient(135deg, #10b981, #059669);
      animation: slideInFromTop 0.3s ease;
    }
    
    @keyframes slideInFromTop {
      0% { opacity: 0; transform: translateY(-20px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    
    /* Course Card Hover Effects */
    .course-card {
      cursor: pointer !important;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }
    
    .course-card:hover {
      transform: translateY(-8px) scale(1.02) !important;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4) !important;
    }
    
    .course-card:active {
      transform: translateY(-4px) scale(0.98) !important;
    }
    
    /* Course Access Badges */
    .no-access-badge {
      z-index: 10;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      animation: pulse 2s ease-in-out infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }
    
    /* Authenticated User Badge */
    .user-badge {
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
      border: 1px solid rgba(255, 255, 255, 0.2);
      animation: glow 2s ease-in-out infinite alternate;
    }
    
    @keyframes glow {
      0% { box-shadow: 0 0 5px rgba(59, 130, 246, 0.5); }
      100% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.8); }
    }
    
    /* Enhanced Select Styling */
    .modal select {
      appearance: none;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
      background-position: left 0.5rem center;
      background-repeat: no-repeat;
      background-size: 1.5em 1.5em;
      padding-left: 2.5rem;
    }
    
    .modal select optgroup {
      background: #f9fafb;
      font-weight: 600;
      font-size: 14px;
    }
    
    .modal select option {
      padding: 8px 12px;
      font-size: 14px;
    }
    
    .modal select option:hover {
      background: #e5e7eb;
    }

    /* Responsive Modal */
    @media (max-width: 640px) {
      .modal-content {
        margin: 1rem;
        max-width: calc(100% - 2rem);
        padding: 1.5rem;
      }
      
      .otp-input {
        width: 2.5rem !important;
        height: 2.5rem !important;
        font-size: 1.2rem !important;
      }
      
      .modal select {
        background-position: left 0.25rem center;
        padding-left: 2rem;
      }
    }
    
    /* Loading States */
    .btn-loading {
      position: relative;
      color: transparent !important;
    }
    
    .btn-loading::after {
      content: '';
      position: absolute;
      width: 16px;
      height: 16px;
      top: 50%;
      left: 50%;
      margin-left: -8px;
      margin-top: -8px;
      border: 2px solid #ffffff;
      border-radius: 50%;
      border-top-color: transparent;
      animation: spin 1s linear infinite;
    }

    /* ğŸŒ Light Mode */
    .light-mode {
      background: #f9fafb !important;   /* Ø®Ù„ÙÙŠØ© ÙØ§ØªØ­Ø© */
      color: #1e293b !important;        /* Ø§Ù„Ù†ØµÙˆØµ ØºØ§Ù…Ù‚Ø© */
    }
    .light-mode nav {
      background: #ffffffcc !important;
      color: #1e293b !important;
    }
    .light-mode .card {
      background: #ffffff !important;
      color: #1e293b !important;
      border: 1px solid #e5e7eb;
    }
    .light-mode h1, 
    .light-mode h2, 
    .light-mode h3, 
    .light-mode p {
      color: #1e293b !important;
    }
    .light-mode footer {
      background: #f1f5f9 !important;
      color: #1e293b !important;
    }
    .light-mode .modal-content {
      background: #ffffff !important;
      color: #1e293b !important;
    }
    .light-mode button {
      color: white !important;
    }

    /* Teacher Mode Indicator */
    .teacher-mode-badge {
      background: linear-gradient(135deg, #8b5cf6, #a855f7);
      color: white;
      padding: 4px 8px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      box-shadow: 0 2px 4px rgba(139, 92, 246, 0.3);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }
  </style>
</head>
<body class="animated-bg text-white">

  <!-- ğŸš€ Navbar -->
  <nav class="flex items-center justify-between px-4 sm:px-6 py-3 bg-black/40 backdrop-blur-md fixed w-full top-0 z-50">
    <!-- Ø§Ù„Ø´Ø¹Ø§Ø± -->
    <div class="flex items-center gap-3">
      <img src="./project 12/images/WhatsApp_Image_2025-09-06_at_00.31.42_7b113d97-removebg-preview.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©" class="w-10 h-10 sm:w-12 sm:h-12 rounded-full" />
      <span class="text-lg sm:text-xl font-bold">Ù…Ù†ØµØ© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</span>
    </div>

    <!-- Ø§Ù„Ù„ÙŠÙ†ÙƒØ§Øª + Ø§Ù„Ø§Ø²Ø±Ø§Ø± -->
    <div class="hidden md:flex items-center gap-6">
      <a href="#courses" class="hover:text-blue-300">ğŸ“š Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª</a>
      <a href="#teacher" class="hover:text-blue-300">ğŸ‘¨â€ğŸ« Ø§Ù„Ù…Ø¯Ø±Ø³</a>
      <button onclick="toggleTheme()" class="px-3 py-1 bg-white/20 rounded-lg">ğŸŒ“</button>
      <button id="openLogin" class="px-3 sm:px-4 py-2 bg-blue-600 rounded-lg text-sm sm:text-base">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
      <button id="openRegister" class="px-3 sm:px-4 py-2 bg-green-600 rounded-lg text-sm sm:text-base">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
    </div>

    <!-- Ù…ÙŠÙ†Ùˆ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ -->
    <div class="md:hidden">
      <button id="menuToggle" class="px-3 py-2 bg-white/20 rounded-lg">â˜°</button>
    </div>
  </nav>

  <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ -->
 <div id="mobileMenu" class="hidden flex-col gap-4 px-6 py-4 bg-black/90 fixed top-14 right-0 w-2/3 h-screen z-40">
  <a href="#courses" class="hover:text-blue-300">ğŸ“š Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª</a>
  <a href="#teacher" class="hover:text-blue-300">ğŸ‘¨â€ğŸ« Ø§Ù„Ù…Ø¯Ø±Ø³</a>
  <button onclick="toggleTheme()" class="px-4 py-2 bg-white/20 rounded-lg">ğŸŒ“ ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹</button>
  <button id="openLoginMobile" class="px-4 py-2 bg-blue-600 rounded-lg">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
  <button id="openRegisterMobile" class="px-4 py-2 bg-green-600 rounded-lg">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
</div>

  <!-- ğŸŒŸ Hero Section -->

<header class="h-[90vh] sm:h-screen flex items-center justify-center relative px-4 sm:px-6">
  <div class="absolute inset-0 bg-black/30"></div>
  <div class="relative z-10 grid grid-cols-1 md:grid-cols-2 gap-6 sm:gap-10 items-center">
    
    <!-- Ø§Ù„Ù†ØµÙˆØµ -->
    <div class="text-center md:text-right order-2 md:order-1">
      <div class="flex flex-col items-center md:items-start">
        <img src="./project 12/images/WhatsApp_Image_2025-09-06_at_00.31.42_7b113d97-removebg-preview.png" 
             alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©" 
             class="w-20 h-20 mb-4 rounded-full shadow-lg" />
        <h1 class="text-4xl sm:text-5xl md:text-6xl font-extrabold mb-4 drop-shadow-lg">
          <span id="typed-text" class="text-blue-400"></span>
        </h1>
      </div>
      <p class="text-base sm:text-lg md:text-xl mt-6 max-w-xl mx-auto md:mx-0">
        ØªØ¹Ù„Ù… Ù…Ø§Ø¯Ø© Ø§Ù„Ø±ÙŠØ§Ø¶Ø© Ù…Ø¹ Ø§Ù„Ø£Ø³ØªØ§Ø° Ù…Ø¬Ø¯ÙŠ Ø¬Ù…Ø§Ù„ - Ø®Ø¨Ø±Ø© ÙÙŠ ØªØ¯Ø±ÙŠØ³ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ©.
      </p>
    </div>

    <!-- ØµÙˆØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ -->
    <div class="flex justify-center order-1 md:order-2">
      <div class="relative">
        <img src="./project 12/images/ØªØµÙ…ÙŠÙ…_Ø¨Ø¯ÙˆÙ†_Ø¹Ù†ÙˆØ§Ù†-removebg-preview.png" 
             alt="Ø§Ù„Ø£Ø³ØªØ§Ø° Ù…Ø¬Ø¯ÙŠ" 
             class="profile-img w-60 sm:w-80 md:w-[420px] rounded-3xl shadow-2xl" />
        
        <!-- Teacher Mode Indicator (Auto based on user role) -->
        <div id="teacherModeIndicator" class="absolute -bottom-4 left-1/2 transform -translate-x-1/2 teacher-mode-badge hidden">
          ğŸ‘¨â€ï¿½ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¹Ù„Ù…
        </div>
      </div>
    </div>
  </div>
</header>


  <!-- ğŸ‘¨â€ğŸ« About Teacher -->
  <section id="teacher" class="py-14 sm:py-20 px-4 sm:px-5 bg-white/10 backdrop-blur-md rounded-3xl shadow-2xl mx-2 sm:mx-4 my-8 sm:my-10">
    <div class="container mx-auto text-center">
      <h2 class="text-3xl sm:text-4xl font-bold mb-6 sm:mb-8 text-white">Ø§Ù„Ø£Ø³ØªØ§Ø° Ù…Ø¬Ø¯ÙŠ</h2>
      <p class="text-base sm:text-lg mb-6 sm:mb-8 max-w-3xl mx-auto text-gray-200">
                                              Ø§Ù„Ø£Ø³ØªØ§Ø° Ù…Ø¬Ø¯ÙŠ Ø¬Ù…Ø§Ù„ Ù‡Ùˆ Ù…Ø¯Ø±Ø³ Ù…Ø§Ø¯Ø© Ø§Ù„Ø±ÙŠØ§Ø¶Ø© Ø§Ù„Ù…ØªØ®ØµØµØŒ ÙŠØ´Ø±Ø­ Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ ÙˆØ§Ù„Ø«Ø§Ù†ÙŠ ÙˆØ§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø¨Ø£Ø³Ù„ÙˆØ¨ ÙˆØ§Ø¶Ø­ ÙˆÙ…Ù…ØªØ¹ ÙŠØ³Ø§Ø¹Ø¯ Ø¹Ù„Ù‰ Ø§Ù„ÙÙ‡Ù… Ø§Ù„Ø³Ù‡Ù„ ÙˆØ§Ù„ØªÙÙˆÙ‚ ÙƒÙ…Ø§ Ù‚Ø§Ù„ Ø§Ù„Ù…Ø³ØªØ± Ø§Ù„ÙˆØ§Ø­Ø¯ Ù…Ù†Ù†Ø§ Ø¨Ø§Ù„Ù .
      </p>
      <img src="./project 12/images/photo_2025-09-03_00-20-27.jpg" alt="ØµÙˆØ±Ø© Ø§Ù„Ø£Ø³ØªØ§Ø° Ù…Ø¬Ø¯ÙŠ" class="profile-img mx-auto w-32 sm:w-44" />
    </div>
  </section>

  <!-- ğŸ“š Courses -->
  <section id="courses" class="py-14 sm:py-20 px-4 sm:px-5 bg-gradient-to-r from-blue-500 to-teal-500">
    <div class="container mx-auto">
      <h2 class="text-3xl sm:text-4xl font-bold text-center mb-8 sm:mb-10">ğŸ“š Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-6 sm:gap-8">

        <div class="card course-card bg-white text-gray-800 p-6 rounded-xl shadow-lg flex flex-col items-center">
          <img src="./project 12/images/photo_2025-09-03_23-36-50.jpg" alt="Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„" class="w-24 h-24 mb-4 rounded-full shadow-md object-cover" />
          <h3 class="text-xl sm:text-2xl font-semibold mb-2">Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</h3>
          <p class="text-center">Ø¯Ø±ÙˆØ³ ØªØ£Ø³ÙŠØ³ÙŠØ© Ø´Ø§Ù…Ù„Ø© ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶Ø©.</p>
        </div>

        <div class="card course-card bg-white text-gray-800 p-6 rounded-xl shadow-lg flex flex-col items-center">
          <img src="./project 12/images/photo_2025-09-03_23-53-13.jpg" alt="Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ù„Ù…ÙŠ" class="w-24 h-24 mb-4 rounded-full shadow-md object-cover" />
          <h3 class="text-xl sm:text-2xl font-semibold mb-2">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ - Ø¹Ù„Ù…ÙŠ</h3>
          <p class="text-center">Ø±ÙŠØ§Ø¶Ø© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ù„Ø´Ø¹Ø¨Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ©.</p>
        </div>

        <div class="card course-card bg-white text-gray-800 p-6 rounded-xl shadow-lg flex flex-col items-center">
          <img src="./project 12/images/photo_2025-09-03_23-53-13.jpg" alt="Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø£Ø¯Ø¨ÙŠ" class="w-24 h-24 mb-4 rounded-full shadow-md object-cover" />
          <h3 class="text-xl sm:text-2xl font-semibold mb-2">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ - Ø£Ø¯Ø¨ÙŠ</h3>
          <p class="text-center">Ø±ÙŠØ§Ø¶Ø© Ø§Ù„Ø´Ø¹Ø¨Ø© Ø§Ù„Ø£Ø¯Ø¨ÙŠØ© Ø§Ù„Ù…Ø¨Ø³Ø·Ø©.</p>
        </div>

        <div class="card course-card bg-white text-gray-800 p-6 rounded-xl shadow-lg flex flex-col items-center">
          <img src="./project 12/images/photo_2025-09-03_23-53-17.jpg" alt="Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø¹Ù„Ù…ÙŠ" class="w-24 h-24 mb-4 rounded-full shadow-md object-cover" />
          <h3 class="text-xl sm:text-2xl font-semibold mb-2">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« - Ø¹Ù„Ù…ÙŠ</h3>
          <p class="text-center">Ù…Ø±Ø§Ø¬Ø¹Ø© Ù†Ù‡Ø§Ø¦ÙŠØ© ÙˆØªØ­Ø¶ÙŠØ± Ù„Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø© - Ø§Ù„Ø´Ø¹Ø¨Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ©.</p>
        </div>

        <div class="card course-card bg-white text-gray-800 p-6 rounded-xl shadow-lg flex flex-col items-center">
          <img src="./project 12/images/photo_2025-09-03_23-53-16.jpg" alt="Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø£Ø¯Ø¨ÙŠ" class="w-24 h-24 mb-4 rounded-full shadow-md object-cover" />
          <h3 class="text-xl sm:text-2xl font-semibold mb-2">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« - Ø£Ø¯Ø¨ÙŠ</h3>
          <p class="text-center">Ù…Ø±Ø§Ø¬Ø¹Ø© Ù†Ù‡Ø§Ø¦ÙŠØ© ÙˆØªØ­Ø¶ÙŠØ± Ù„Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø© - Ø§Ù„Ø´Ø¹Ø¨Ø© Ø§Ù„Ø£Ø¯Ø¨ÙŠØ©.</p>
        </div>

      </div>
    </div>
  </section>

  <!-- ğŸ“© Footer -->
  <footer class="bg-gray-900 text-white py-10 text-center px-4">
    <p>Â© 2025 Ù…Ù†ØµØ© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ù„Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
    <p class="mt-2">ğŸ“§ ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§: info@magdijamal-sport.com</p>
  </footer>

  <!-- ğŸ”‘ Login Modal -->
  <div id="loginModal" class="modal">
    <div class="modal-content">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-bold">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
        <button onclick="closeModal('loginModal')" class="text-2xl hover:text-red-500">âœ–ï¸</button>
      </div>
      
      <!-- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ -->
      <div id="loginErrors" class="mb-4 p-3 bg-red-500/20 text-red-300 rounded-lg hidden"></div>
      <div id="loginSuccess" class="mb-4 p-3 bg-green-500/20 text-green-300 rounded-lg hidden"></div>
      
      <form id="loginForm" class="flex flex-col gap-4">
        <input type="email" id="loginEmail" name="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required class="p-3 rounded bg-white/20 placeholder-gray-300" />
        <input type="password" id="loginPassword" name="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required class="p-3 rounded bg-white/20 placeholder-gray-300" />
        
        <button type="submit" class="bg-blue-600 hover:bg-blue-700 py-3 rounded-lg font-bold transition-colors duration-300" id="loginBtn">
          ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        </button>
        
        <button type="button" onclick="openForgotPasswordModal()" class="text-blue-400 hover:text-blue-300 text-sm underline">
          Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŸ
        </button>
        
        <p class="text-sm text-center text-gray-300">
          Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ 
          <button type="button" onclick="closeModal('loginModal'); openModal('registerModal')" class="text-green-400 hover:text-green-300 underline">
            Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
          </button>
        </p>
      </form>
    </div>
  </div>

  <!-- ğŸ†• Signup Modal -->
  <div id="registerModal" class="modal">
    <div class="modal-content max-h-[90vh] overflow-y-auto">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-bold">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h2>
        <button onclick="closeModal('registerModal')" class="text-2xl hover:text-red-500">âœ–ï¸</button>
      </div>
      
      <!-- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ -->
      <div id="registerErrors" class="mb-4 p-3 bg-red-500/20 text-red-300 rounded-lg hidden"></div>
      <div id="registerSuccess" class="mb-4 p-3 bg-green-500/20 text-green-300 rounded-lg hidden"></div>
      
      <form id="signupForm" class="flex flex-col gap-4">
        <input type="text" id="fullName" name="fullName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ ÙƒØ§Ù…Ù„Ø§Ù‹ (Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ Ø§Ù„Ø³ÙŠØ¯)" required minlength="10" maxlength="100" class="p-3 rounded bg-white/20 placeholder-gray-300" />
        <div id="fullNameIndicator" class="mt-1 text-xs text-white/70 hidden">
          <span id="nameCount">0/100 Ø­Ø±Ù</span>
        </div>
        
        <input type="email" id="signupEmail" name="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required class="p-3 rounded bg-white/20 placeholder-gray-300" />
        <input type="password" id="signupPassword" name="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± (8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)" required class="p-3 rounded bg-white/20 placeholder-gray-300" />
        
        <select id="location" name="location" required class="p-3 rounded bg-white text-gray-800 border border-gray-300">
          <option value="" disabled selected>Ø§Ø®ØªØ± Ø§Ù„Ù…ÙƒØ§Ù†</option>
          <option value="Ø§Ù„Ø¹Ø³ÙŠØ±Ø§Øª">Ø§Ù„Ø¹Ø³ÙŠØ±Ø§Øª</option>
          <option value="Ø§Ù„Ù…Ù†Ø´Ø§Ø©">Ø§Ù„Ù…Ù†Ø´Ø§Ø©</option>
          <option value="Ø§Ù„Ø§Ø¬Ø§ÙŠÙˆÙ‡">Ø§Ù„Ø§Ø¬Ø§ÙŠÙˆÙ‡</option>
        </select>
        
        <select id="signupGrade" name="grade" required class="p-3 rounded bg-white text-gray-800 border border-gray-300">
          <option value="" disabled selected>Ø§Ø®ØªØ± Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</option>
          <optgroup label="Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ©" class="bg-purple-50">
            <option value="Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ">Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
            <option value="Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø¹Ù„Ù…ÙŠ">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø¹Ù„Ù…ÙŠ</option>
            <option value="Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø§Ø¯Ø¨ÙŠ">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø§Ø¯Ø¨ÙŠ</option>
            <option value="Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø¹Ù„Ù…ÙŠ">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø¹Ù„Ù…ÙŠ</option>
            <option value="Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø§Ø¯Ø¨ÙŠ">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø§Ø¯Ø¨ÙŠ</option>
          </optgroup>
        </select>
        
        <input type="tel" id="phone" name="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" class="p-3 rounded bg-white/20 placeholder-gray-300" />
        
        <button type="submit" class="bg-green-600 hover:bg-green-700 py-3 rounded-lg font-bold transition-colors duration-300" id="registerBtn">
          Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨
        </button>
        
        <p class="text-sm text-center text-gray-300">
          Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ 
          <button type="button" onclick="closeModal('registerModal'); openModal('loginModal')" class="text-blue-400 hover:text-blue-300 underline">
            ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
          </button>
        </p>
      </form>
    </div>
  </div>

  <!-- ğŸ“± OTP Verification Modal -->
  <div id="otpModal" class="modal">
    <div class="modal-content">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-bold">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨</h2>
        <button onclick="closeModal('otpModal')" class="text-2xl hover:text-red-500">âœ–ï¸</button>
      </div>
      
      <div class="text-center mb-6">
        <p class="text-gray-300 mb-2">ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</p>
        <p class="text-blue-400 font-semibold" id="otpEmailDisplay"></p>
      </div>
      
      <!-- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ -->
      <div id="otpErrors" class="mb-4 p-3 bg-red-500/20 text-red-300 rounded-lg hidden"></div>
      <div id="otpSuccess" class="mb-4 p-3 bg-green-500/20 text-green-300 rounded-lg hidden"></div>
      
      <form id="otpForm" class="flex flex-col gap-4">
        <div class="flex justify-center gap-2 mb-4">
          <input type="text" class="otp-input w-12 h-12 text-center text-2xl bg-white/20 rounded-lg" maxlength="1" />
          <input type="text" class="otp-input w-12 h-12 text-center text-2xl bg-white/20 rounded-lg" maxlength="1" />
          <input type="text" class="otp-input w-12 h-12 text-center text-2xl bg-white/20 rounded-lg" maxlength="1" />
          <input type="text" class="otp-input w-12 h-12 text-center text-2xl bg-white/20 rounded-lg" maxlength="1" />
          <input type="text" class="otp-input w-12 h-12 text-center text-2xl bg-white/20 rounded-lg" maxlength="1" />
          <input type="text" class="otp-input w-12 h-12 text-center text-2xl bg-white/20 rounded-lg" maxlength="1" />
        </div>
        
        <button type="submit" class="bg-green-600 hover:bg-green-700 py-3 rounded-lg font-bold transition-colors duration-300" id="verifyOtpBtn">
          ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨
        </button>
        
        <div class="text-center">
          <p class="text-sm text-gray-300 mb-2">Ù„Ù… ØªØ³ØªÙ„Ù… Ø§Ù„Ø±Ù…Ø²ØŸ</p>
          <button type="button" onclick="resendOTP()" class="text-blue-400 hover:text-blue-300 text-sm underline" id="resendOtpBtn">
            Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
          </button>
          <span id="resendTimer" class="text-sm text-gray-400 ml-2"></span>
        </div>
      </form>
    </div>
  </div>

  <!-- ğŸ”’ Forgot Password Modal -->
  <div id="forgotPasswordModal" class="modal">
    <div class="modal-content">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-bold">Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h2>
        <button onclick="closeModal('forgotPasswordModal')" class="text-2xl hover:text-red-500">âœ–ï¸</button>
      </div>
      
      <p class="text-gray-300 mb-4 text-center">
        Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆØ³Ù†Ø±Ø³Ù„ Ù„Ùƒ Ø±Ø§Ø¨Ø· Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
      </p>
      
      <!-- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ -->
      <div id="forgotPasswordErrors" class="mb-4 p-3 bg-red-500/20 text-red-300 rounded-lg hidden"></div>
      <div id="forgotPasswordSuccess" class="mb-4 p-3 bg-green-500/20 text-green-300 rounded-lg hidden"></div>
      
      <form id="forgotPasswordForm" class="flex flex-col gap-4">
        <input type="email" id="forgotEmail" name="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" required class="p-3 rounded bg-white/20 placeholder-gray-300" />
        
        <button type="submit" class="bg-purple-600 hover:bg-purple-700 py-3 rounded-lg font-bold transition-colors duration-300" id="forgotPasswordBtn">
          Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©
        </button>
        
        <button type="button" onclick="closeModal('forgotPasswordModal'); openModal('loginModal')" class="text-blue-400 hover:text-blue-300 text-sm underline">
          Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        </button>
      </form>
    </div>
  </div>

  <!-- ğŸ”„ Reset Password Modal -->
  <div id="resetPasswordModal" class="modal">
    <div class="modal-content">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-2xl font-bold">ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø©</h2>
        <button onclick="closeModal('resetPasswordModal')" class="text-2xl hover:text-red-500">âœ–ï¸</button>
      </div>
      
      <!-- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ -->
      <div id="resetPasswordErrors" class="mb-4 p-3 bg-red-500/20 text-red-300 rounded-lg hidden"></div>
      <div id="resetPasswordSuccess" class="mb-4 p-3 bg-green-500/20 text-green-300 rounded-lg hidden"></div>
      
      <form id="resetPasswordForm" class="flex flex-col gap-4">
        <input type="password" id="newPassword" name="newPassword" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)" required class="p-3 rounded bg-white/20 placeholder-gray-300" />
        <input type="password" id="confirmNewPassword" name="confirmNewPassword" placeholder="ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©" required class="p-3 rounded bg-white/20 placeholder-gray-300" />
        
        <button type="submit" class="bg-green-600 hover:bg-green-700 py-3 rounded-lg font-bold transition-colors duration-300" id="resetPasswordBtn">
          Ø­ÙØ¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        </button>
      </form>
    </div>
  </div>

  <!-- âš¡ Scripts -->
  <script>
    // ============= Configuration & Constants =============
    const API_BASE_URL = 'https://courses-pj.vercel.app/api';
    const TEST_MODE = false; // Set to true for testing without backend
    
    let resendTimer = 0;
    let resendInterval;

    // ============= Form Validation Functions =============
    
    // Validate email format
    function validateEmail(email) {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return emailRegex.test(email);
    }
    
    // Validate password strength
    function validatePassword(password) {
      return password.length >= 8 && 
             /[A-Z]/.test(password) && 
             /[a-z]/.test(password) && 
             /\d/.test(password);
    }
    
    // Validate Arabic/English names (2-20 characters)
    function validateName(name) {
      const nameRegex = /^[\u0621-\u064A\u0660-\u0669a-zA-Z\s]{2,20}$/;
      return nameRegex.test(name.trim());
    }
    
    // Validate Egyptian phone number
    function validatePhone(phone) {
      if (!phone) return true; // Optional field
      const phoneRegex = /^(010|011|012|015)\d{8}$/;
      return phoneRegex.test(phone.replace(/\s|-/g, ''));
    }
    
    // Validate full name according to backend requirements
    function validateFullName(fullName) {
      if (!fullName || typeof fullName !== 'string') {
        return false;
      }
      
      const trimmedName = fullName.trim();
      
      // Check length (10-100 characters)
      if (trimmedName.length < 10 || trimmedName.length > 100) {
        return false;
      }
      
      // Check that it contains only letters and spaces (Arabic or English)
      const nameRegex = /^[\u0621-\u064A\u0660-\u0669a-zA-Z\s]+$/;
      if (!nameRegex.test(trimmedName)) {
        return false;
      }
      
      // Check that it contains at least 3 separate names
      const names = trimmedName.split(/\s+/).filter(name => name.length > 0);
      if (names.length < 3) {
        return false;
      }
      
      // Check each name part (at least 2 characters each)
      return names.every(name => name.length >= 2);
    }
    
    // Split full name into parts
    function splitFullName(fullName) {
      if (!fullName || typeof fullName !== 'string') {
        console.error('Invalid fullName provided:', fullName);
        return {
          firstName: '',
          secondName: '',
          thirdName: '',
          fourthName: ''
        };
      }
      
      const names = fullName.trim().split(/\s+/).filter(name => name.length > 0);
      return {
        firstName: names[0] || '',
        secondName: names[1] || '',
        thirdName: names[2] || '',
        fourthName: names[3] || names[2] || '' // If only 3 names, use third as fourth
      };
    }

    // Validate registration form
    function validateRegistrationForm(formData) {
      console.log('ğŸ” Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„...');
      const errors = [];
      
      const fullName = formData.get('fullName');
      const email = formData.get('email');
      const password = formData.get('password');
      const location = formData.get('location');
      const grade = formData.get('grade');
      const phone = formData.get('phone');
      
      console.log('ğŸ“ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø©:', {
        fullName: fullName ? `"${fullName.substring(0, 30)}" (${fullName.length} Ø­Ø±Ù)` : 'ÙØ§Ø±Øº',
        email: email || 'ÙØ§Ø±Øº',
        phone: phone || 'ÙØ§Ø±Øº',
        location: location || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
        grade: grade || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'
      });
      
      // Validate full name with detailed logging
      console.log('ğŸ”¤ ÙØ­Øµ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ...');
      if (!fullName || !fullName.trim()) {
        console.log('âŒ Ø§Ù„Ø§Ø³Ù… ÙØ§Ø±Øº');
        errors.push('Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ Ù…Ø·Ù„ÙˆØ¨');
      } else {
        const nameLength = fullName.trim().length;
        const isNameValid = validateFullName(fullName);
        console.log(`ğŸ“ Ø·ÙˆÙ„ Ø§Ù„Ø§Ø³Ù…: ${nameLength}ØŒ ØµØ­ÙŠØ­: ${isNameValid}`);
        
        if (nameLength < 10) {
          errors.push(`Ø§Ù„Ø§Ø³Ù… Ù‚ØµÙŠØ± Ø¬Ø¯Ø§Ù‹ - Ø£Ø¯Ø®Ù„ ${10 - nameLength} Ø­Ø±Ù Ø¥Ø¶Ø§ÙÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„`);
        } else if (nameLength > 100) {
          errors.push(`Ø§Ù„Ø§Ø³Ù… Ø·ÙˆÙŠÙ„ Ø¬Ø¯Ø§Ù‹ - Ø§Ø­Ø°Ù ${nameLength - 100} Ø­Ø±Ù`);
        } else if (!isNameValid) {
          const nameParts = fullName.trim().split(/\s+/).filter(part => part.length > 0);
          console.log(`ğŸ”¢ Ø¹Ø¯Ø¯ Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„Ø§Ø³Ù…: ${nameParts.length}`);
          if (nameParts.length < 3) {
            errors.push(`ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ 3 Ø£Ø³Ù…Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù…ÙØµÙˆÙ„Ø© Ø¨Ù…Ø³Ø§ÙØ§Øª (Ù„Ø¯ÙŠÙƒ ${nameParts.length} ÙÙ‚Ø·)`);
          }
        }
      }
      
      if (!validateEmail(email)) {
        errors.push('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­');
      }
      if (!validatePassword(password)) {
        errors.push('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ 8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù…Ø¹ Ø­Ø±Ù ÙƒØ¨ÙŠØ± ÙˆØµØºÙŠØ± ÙˆØ±Ù‚Ù…');
      }
      if (!location) {
        errors.push('ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙƒØ§Ù†');
      }
      if (!grade) {
        errors.push('ÙŠØ¬Ø¨ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ');
      }
      if (phone && phone.trim() && !validatePhone(phone)) {
        errors.push('Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ØºÙŠØ± ØµØ­ÙŠØ­ (ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 010, 011, 012, Ø£Ùˆ 015)');
      }
      
      console.log(errors.length === 0 ? 'âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø©!' : 'âŒ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©:', errors);
      return errors;
    }
    
    // Validate login form
    function validateLoginForm(email, password) {
      const errors = [];
      
      if (!validateEmail(email)) {
        errors.push('Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­');
      }
      if (!password || password.length < 8) {
        errors.push('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
      }
      
      return errors;
    }

    // ============= Authentication Utility Functions =============
    
    // Get auth token from localStorage
    function getAuthToken() {
      return localStorage.getItem('authToken');
    }
    
    // Get user data from localStorage
    function getCurrentUser() {
      const userStr = localStorage.getItem('user');
      return userStr ? JSON.parse(userStr) : null;
    }
    
    // Check if user is logged in
    function isLoggedIn() {
      return getAuthToken() && getCurrentUser();
    }
    
    // Save user session
    function saveUserSession(token, user) {
      localStorage.setItem('authToken', token);
      localStorage.setItem('user', JSON.stringify(user));
    }
    
    // Clear user session
    function clearUserSession() {
      localStorage.removeItem('authToken');
      localStorage.removeItem('user');
      localStorage.removeItem('tempToken');
      localStorage.removeItem('userEmail');
    }
    
    // Show loading state
    function showLoading(buttonId, text = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...') {
      const button = document.getElementById(buttonId);
      button.innerHTML = text;
      button.disabled = true;
    }
    
    // Hide loading state
    function hideLoading(buttonId, originalText) {
      const button = document.getElementById(buttonId);
      button.innerHTML = originalText;
      button.disabled = false;
    }
    
    // Show error message
    function showError(containerId, message) {
      const container = document.getElementById(containerId);
      container.innerHTML = message;
      container.classList.remove('hidden');
      setTimeout(() => container.classList.add('hidden'), 5000);
    }
    
    // Show success message
    function showSuccess(containerId, message) {
      const container = document.getElementById(containerId);
      container.innerHTML = message;
      container.classList.remove('hidden');
      setTimeout(() => container.classList.add('hidden'), 5000);
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      console.log('Page loaded, initializing...');
      
      updateGlobalModeDisplay();
      checkAuthState();
      setupEventListeners();
      addCourseCardHandlers();
      // Ø¶Ù…Ø§Ù† Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙÙˆØ± Ø§Ù„ØªØ­Ù…ÙŠÙ„
      if (typeof attachAuthButtonHandlers === 'function') {
        attachAuthButtonHandlers();
      }
      
      // Update course visibility after auth state is checked
      setTimeout(updateCourseVisibility, 100);
      
      console.log('Event listeners set up');
      
      // Typed effect
      new Typed('#typed-text', {
        strings: ['ğŸš€ Ù…Ù†ØµØ© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©', 'âœ¨ Ù…Ø³ØªÙ‚Ø¨Ù„Ùƒ ÙŠØ¨Ø¯Ø£ Ù…Ù† Ù‡Ù†Ø§', 'ğŸ“š ØªØ¹Ù„Ù… ÙˆØªÙÙˆÙ‚ Ù…Ø¹ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©'],
        typeSpeed: 60,
        backSpeed: 40,
        loop: true
      });

      // Check for reset password token in URL
      const urlParams = new URLSearchParams(window.location.search);
      const resetToken = urlParams.get('reset-token');
      if (resetToken) {
        localStorage.setItem('resetToken', resetToken);
        openModal('resetPasswordModal');
      }
    });

    // ============= Authentication Functions =============
    
    // Register new user
    async function registerUser(formData) {
      // Debug: Log form data
      console.log('Form Data received:', formData);
      for (let pair of formData.entries()) {
        console.log(pair[0] + ': ' + pair[1]);
      }
      
      // Client-side validation
      const validationErrors = validateRegistrationForm(formData);
      if (validationErrors.length > 0) {
        showError('registerErrors', validationErrors.join('<br>'));
        return;
      }
      
      showLoading('registerBtn', 'Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨...');
      
      const fullName = formData.get('fullName');
      
      // Additional validation
      if (!fullName) {
        showError('registerErrors', 'Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ Ù…Ø·Ù„ÙˆØ¨');
        return;
      }
      
      // Validate full name using existing validation function
      if (!validateFullName(fullName)) {
        showError('registerErrors', 'ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø±Ø¨Ø§Ø¹ÙŠ ØµØ­ÙŠØ­ (3 Ø£Ø³Ù…Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ØŒ 10-100 Ø­Ø±Ù)');
        return;
      }
      
      const userData = {
        name: fullName.trim(), // Send full name as single field
        email: formData.get('email'),
        password: formData.get('password'),
        location: formData.get('location'),
        grade: formData.get('grade'),
        role: 'student' // Always student as requested
      };

      // Add phone number only if provided
      const phoneNumber = formData.get('phone');
      if (phoneNumber && phoneNumber.trim()) {
        userData.phoneNumber = phoneNumber.trim();
      }
      
      // Clean up userData - remove undefined values
      Object.keys(userData).forEach(key => {
        if (userData[key] === undefined) {
          delete userData[key];
        }
      });

      console.log('ğŸ“¤ User data to be sent:', userData);
      console.log('ğŸ“ Form data details:', {
        name: `"${userData.name}" (${userData.name?.length} Ø­Ø±Ù)`,
        email: userData.email,
        password: userData.password ? `${userData.password.length} Ø­Ø±Ù` : 'ÙØ§Ø±Øº',
        phoneNumber: userData.phoneNumber || 'ØºÙŠØ± Ù…ØªÙˆÙØ±',
        location: userData.location,
        grade: userData.grade
      });

      try {
        if (TEST_MODE) {
          // Test mode - simulate successful registration
          console.log('TEST MODE: Simulating successful registration');
          showSuccess('registerSuccess', 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­ (ÙˆØ¶Ø¹ Ø§Ø®ØªØ¨Ø§Ø±)');
          setTimeout(() => {
            closeModal('registerModal');
            openOtpModal(userData.email);
          }, 1500);
          return;
        }
        
        console.log('Sending request to:', `${API_BASE_URL}/users/`);
        console.log('Request payload:', JSON.stringify(userData));
        
        const response = await fetch(`${API_BASE_URL}/users/`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(userData)
        });
        
        console.log('Response status:', response.status);
        console.log('Response headers:', response.headers);
        
        const result = await response.json();
        console.log('ğŸ“¥ Response data:', result);
        
        if (response.ok) {
          // Success - store temp token and show OTP modal
          console.log('âœ… Registration successful!');
          localStorage.setItem('tempToken', result.tempToken);
          localStorage.setItem('userEmail', result.user.email);
          
          showSuccess('registerSuccess', result.message);
          setTimeout(() => {
            closeModal('registerModal');
            openOtpModal(result.user.email);
          }, 1500);
        } else {
          // Handle errors
          console.log('âŒ Registration failed with status:', response.status);
          if (result.errors && Array.isArray(result.errors)) {
            console.log('ğŸš« Server validation errors:', result.errors);
            const errorMessages = result.errors
              .map(error => `â€¢ ${error.msg}`)
              .join('<br>');
            showError('registerErrors', `Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:<br>${errorMessages}`);
          } else {
            showError('registerErrors', result.message);
          }
        }
      } catch (error) {
        console.error('Registration error:', error);
        
        if (error.name === 'TypeError' && error.message.includes('fetch')) {
          showError('registerErrors', 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø§Ùƒ Ø¥Ù†Ø¯ Ø¹Ù„Ù‰ https://courses-pj.vercel.app');
        } else {
          showError('registerErrors', `Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ${error.message}`);
        }
      } finally {
        hideLoading('registerBtn', 'Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨');
      }
    }

    // Login user
    async function loginUser(email, password) {
      console.log('Login attempt:', { email }); // Don't log password
      
      // Client-side validation
      const validationErrors = validateLoginForm(email, password);
      if (validationErrors.length > 0) {
        showError('loginErrors', validationErrors.join('<br>'));
        return;
      }
      
      showLoading('loginBtn', 'Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...');
      
      try {
        const response = await fetch(`${API_BASE_URL}/users/login`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ email, password })
        });
        
        const result = await response.json();
        
        if (response.ok) {
          // Success - save session and redirect
          saveUserSession(result.token, result.user);
          showSuccess('loginSuccess', result.message);
          
          setTimeout(() => {
            closeModal('loginModal');
            updateNavbar();
            showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰', 'success');
          }, 1500);
          
        } else if (response.status === 403 && result.requiresVerification) {
          // Account not verified - show OTP modal
          localStorage.setItem('userEmail', result.userEmail);
          closeModal('loginModal');
          openOtpModal(result.userEmail);
          showError('otpErrors', 'ÙŠØ¬Ø¨ ØªÙØ¹ÙŠÙ„ Ø­Ø³Ø§Ø¨Ùƒ Ø£ÙˆÙ„Ø§Ù‹');
          
        } else {
          showError('loginErrors', result.message);
        }
      } catch (error) {
        console.error('Login error:', error);
        showError('loginErrors', 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
      } finally {
        hideLoading('loginBtn', 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„');
      }
    }

    // Verify OTP
    async function verifyOTP(email, otp) {
      showLoading('verifyOtpBtn', 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...');
      
      try {
        const response = await fetch(`${API_BASE_URL}/users/verify-otp`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ email, otp })
        });
        
        const result = await response.json();
        
        if (response.ok) {
          // Success - save permanent token
          saveUserSession(result.token, result.user);
          showSuccess('otpSuccess', result.message);
          
          setTimeout(() => {
            closeModal('otpModal');
            updateNavbar();
            showNotification('ØªÙ… ØªÙØ¹ÙŠÙ„ Ø­Ø³Ø§Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰', 'success');
          }, 1500);
          
        } else {
          showError('otpErrors', result.message);
        }
      } catch (error) {
        console.error('OTP verification error:', error);
        showError('otpErrors', 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
      } finally {
        hideLoading('verifyOtpBtn', 'ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨');
      }
    }

    // Resend OTP
    async function resendOTP() {
      const email = localStorage.getItem('userEmail');
      if (!email) return;
      
      const button = document.getElementById('resendOtpBtn');
      button.disabled = true;
      button.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...';
      
      try {
        const response = await fetch(`${API_BASE_URL}/users/resend-otp`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ email })
        });
        
        const result = await response.json();
        
        if (response.ok) {
          showSuccess('otpSuccess', result.message);
          startResendTimer();
        } else {
          showError('otpErrors', result.message);
          button.disabled = false;
          button.textContent = 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„';
        }
      } catch (error) {
        console.error('Resend OTP error:', error);
        showError('otpErrors', 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
        button.disabled = false;
        button.textContent = 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„';
      }
    }

    // Request password reset
    async function requestPasswordReset(email) {
      showLoading('forgotPasswordBtn', 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...');
      
      try {
        const response = await fetch(`${API_BASE_URL}/users/reset-password/request`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ email })
        });
        
        const result = await response.json();
        
        if (response.ok) {
          showSuccess('forgotPasswordSuccess', 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ');
          document.getElementById('forgotPasswordForm').reset();
        } else {
          showError('forgotPasswordErrors', result.message);
        }
      } catch (error) {
        console.error('Password reset request error:', error);
        showError('forgotPasswordErrors', 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
      } finally {
        hideLoading('forgotPasswordBtn', 'Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©');
      }
    }

    // Reset password
    async function resetPassword(newPassword) {
      const token = localStorage.getItem('resetToken');
      if (!token) {
        showError('resetPasswordErrors', 'Ø±Ù…Ø² Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© ØºÙŠØ± ØµØ§Ù„Ø­');
        return;
      }
      
      showLoading('resetPasswordBtn', 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...');
      
      try {
        const response = await fetch(`${API_BASE_URL}/users/reset-password/perform`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ token, newPassword })
        });
        
        const result = await response.json();
        
        if (response.ok) {
          showSuccess('resetPasswordSuccess', 'ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­');
          localStorage.removeItem('resetToken');
          
          setTimeout(() => {
            closeModal('resetPasswordModal');
            openModal('loginModal');
            showNotification('ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©', 'success');
          }, 2000);
        } else {
          showError('resetPasswordErrors', result.message);
        }
      } catch (error) {
        console.error('Password reset error:', error);
        showError('resetPasswordErrors', 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
      } finally {
        hideLoading('resetPasswordBtn', 'Ø­ÙØ¸ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©');
      }
    }

    // Logout user
    function logoutUser() {
      clearUserSession();
      updateNavbar();
      showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­', 'info');
    }

    // Update mode display based on user role (automatic)
    function updateGlobalModeDisplay() {
      if (typeof AUTH !== 'undefined' && AUTH.updateAutoModeDisplay) {
        AUTH.updateAutoModeDisplay();
      }
      // Also update using teacher mode system if available
      if (typeof TeacherMode !== 'undefined' && TeacherMode.updateModeDisplay) {
        TeacherMode.updateModeDisplay();
      }
    }

    // Show notification
    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.className = `fixed top-20 right-4 px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300 ${
        type === 'success' ? 'bg-green-600 text-white' : 
        type === 'error' ? 'bg-red-600 text-white' : 
        'bg-blue-600 text-white'
      }`;
      notification.textContent = message;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.opacity = '0';
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
          document.body.removeChild(notification);
        }, 300);
      }, 3000);
    }

    // ğŸŒ™ Light / Dark Mode
    function toggleTheme() {
      document.body.classList.toggle("light-mode");
    }

    // ============= UI Helper Functions =============
    
    // Open OTP modal
    function openOtpModal(email) {
      document.getElementById('otpEmailDisplay').textContent = email;
      openModal('otpModal');
      startResendTimer();
      setupOtpInputs();
    }
    
    // Open forgot password modal
    function openForgotPasswordModal() {
      closeModal('loginModal');
      openModal('forgotPasswordModal');
    }
    
    // Setup OTP inputs behavior
    function setupOtpInputs() {
      const inputs = document.querySelectorAll('.otp-input');
      inputs.forEach((input, index) => {
        input.addEventListener('input', (e) => {
          if (e.target.value.length === 1 && index < inputs.length - 1) {
            inputs[index + 1].focus();
          }
        });
        
        input.addEventListener('keydown', (e) => {
          if (e.key === 'Backspace' && e.target.value === '' && index > 0) {
            inputs[index - 1].focus();
          }
        });
      });
    }
    
    // Get OTP value from inputs
    function getOtpValue() {
      const inputs = document.querySelectorAll('.otp-input');
      return Array.from(inputs).map(input => input.value).join('');
    }
    
    // Clear OTP inputs
    function clearOtpInputs() {
      document.querySelectorAll('.otp-input').forEach(input => input.value = '');
    }
    
    // Start resend timer
    function startResendTimer() {
      resendTimer = 60;
      const button = document.getElementById('resendOtpBtn');
      const timerSpan = document.getElementById('resendTimer');
      
      button.disabled = true;
      
      resendInterval = setInterval(() => {
        timerSpan.textContent = `(${resendTimer})`;
        resendTimer--;
        
        if (resendTimer < 0) {
          clearInterval(resendInterval);
          button.disabled = false;
          button.textContent = 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„';
          timerSpan.textContent = '';
        }
      }, 1000);
    }
    
    // Check authentication state on page load
    function checkAuthState() {
      if (isLoggedIn()) {
        updateNavbar();
      }
    }
    
    // Update navbar based on auth state
    function updateNavbar() {
      const user = getCurrentUser();
      const authButtons = document.querySelector('.hidden.md\\:flex');
      
      if (user && authButtons) {
        const roleText = user.role === 'instructor' ? 'Ù…Ø¯Ø±Ø³' : user.role === 'admin' ? 'Ù…Ø´Ø±Ù' : 'Ø·Ø§Ù„Ø¨';
        const roleColor = user.role === 'instructor' ? 'bg-green-600' : user.role === 'admin' ? 'bg-purple-600' : 'bg-blue-600';
        // Ø§Ø³ØªØ®Ø¯Ø§Ù… window.AUTH Ø¨Ø£Ù…Ø§Ù† Ù„ØªØ¬Ù†Ø¨ ReferenceError Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…Ø­Ù…Ù„Ø§Ù‹ Ø¨Ø¹Ø¯
        const authObj = window.AUTH || {};
        const displayName = typeof authObj.getUserDisplayName === 'function'
          ? authObj.getUserDisplayName()
          : (user.firstName || user.name || 'Ù…Ø³ØªØ®Ø¯Ù…');
        
        authButtons.innerHTML = `
          <a href="#courses" class="hover:text-blue-300">ğŸ“š Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª</a>
          <a href="#teacher" class="hover:text-blue-300">ğŸ‘¨â€ğŸ« Ø§Ù„Ù…Ø¯Ø±Ø³</a>
          <button onclick="toggleTheme()" class="px-3 py-1 bg-white/20 rounded-lg">ğŸŒ“</button>
          <div class="flex items-center gap-2 px-3 py-2 bg-blue-600/20 rounded-lg">
            <span class="text-sm">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ${displayName}</span>
            <span class="text-xs ${roleColor} px-2 py-1 rounded">${roleText}</span>
          </div>
          <button onclick="logoutUser()" class="px-3 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm">Ø®Ø±ÙˆØ¬</button>
        `;
        
        // Update mobile menu too
        const mobileMenu = document.getElementById('mobileMenu');
        mobileMenu.innerHTML = `
          <a href="#courses" class="hover:text-blue-300">ğŸ“š Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª</a>
          <a href="#teacher" class="hover:text-blue-300">ğŸ‘¨â€ğŸ« Ø§Ù„Ù…Ø¯Ø±Ø³</a>
          <button onclick="toggleTheme()" class="px-4 py-2 bg-white/20 rounded-lg">ğŸŒ“ ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹</button>
          <div class="px-4 py-2 bg-blue-600/20 rounded-lg">
            <div class="text-sm">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ${displayName}</div>
            <div class="text-xs text-blue-300">${user.email}</div>
            <div class="text-xs text-gray-400">${roleText}</div>
          </div>
          <button onclick="logoutUser()" class="px-4 py-2 bg-red-600 rounded-lg">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
        `;
        
        // Update course visibility based on user role and grade
        updateCourseVisibility();
      } else if (!user && authButtons) {
        // Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ â€“ Ù†Ø¶Ù…Ù† Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£ØµÙ„ÙŠØ© (Ù‚Ø¯ ØªÙƒÙˆÙ† Ø§Ø®ØªÙØª Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ Ø³Ø§Ø¨Ù‚)
        authButtons.innerHTML = `
          <a href="#courses" class="hover:text-blue-300">ğŸ“š Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª</a>
          <a href="#teacher" class="hover:text-blue-300">ğŸ‘¨â€ğŸ« Ø§Ù„Ù…Ø¯Ø±Ø³</a>
          <button onclick="toggleTheme()" class="px-3 py-1 bg-white/20 rounded-lg">ğŸŒ“</button>
          <button id="openLogin" class="px-3 sm:px-4 py-2 bg-blue-600 rounded-lg text-sm sm:text-base">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
          <button id="openRegister" class="px-3 sm:px-4 py-2 bg-green-600 rounded-lg text-sm sm:text-base">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
        `;
        // Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ù†Ø§Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ ÙƒØ°Ù„Ùƒ
        const mobileMenu = document.getElementById('mobileMenu');
        if (mobileMenu) {
          mobileMenu.innerHTML = `
            <a href="#courses" class="hover:text-blue-300">ğŸ“š Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª</a>
            <a href="#teacher" class="hover:text-blue-300">ğŸ‘¨â€ğŸ« Ø§Ù„Ù…Ø¯Ø±Ø³</a>
            <button onclick="toggleTheme()" class="px-4 py-2 bg-white/20 rounded-lg">ğŸŒ“ ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹</button>
            <button id="openLoginMobile" class="px-4 py-2 bg-blue-600 rounded-lg">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
            <button id="openRegisterMobile" class="px-4 py-2 bg-green-600 rounded-lg">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
          `;
        }
        // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø§Ù„Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø¨Ø¹Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù€ innerHTML
        attachAuthButtonHandlers();
      }
    }

    // Helper: (Ø¥Ø¹Ø§Ø¯Ø©) Ø±Ø¨Ø· Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ù…Ø¹ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„Ø§Øª â€“ ØªØªØ­Ù…Ù„ Ø§Ù„ØªÙƒØ±Ø§Ø± Ø¨Ø£Ù…Ø§Ù†
    function attachAuthButtonHandlers() {
      const loginBtn = document.getElementById('openLogin');
      const registerBtn = document.getElementById('openRegister');
      const loginBtnMob = document.getElementById('openLoginMobile');
      const registerBtnMob = document.getElementById('openRegisterMobile');

      if (loginBtn) loginBtn.onclick = () => openModal('loginModal');
      if (registerBtn) registerBtn.onclick = () => openModal('registerModal');
      if (loginBtnMob) loginBtnMob.onclick = () => openModal('loginModal');
      if (registerBtnMob) registerBtnMob.onclick = () => openModal('registerModal');

      // ÙƒÙˆØ¯ Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø¹Ø¨Ø± Ø§Ù„ØªÙÙˆÙŠØ¶ â€“ ÙŠØ¶Ù…Ù† Ø§Ù„Ø¹Ù…Ù„ Ø­ØªÙ‰ Ù„Ùˆ ØªØ¨Ø¯Ù„Øª Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù„Ø§Ø­Ù‚Ø§Ù‹
      if (!window.__authDelegationBound) {
        document.addEventListener('click', (e) => {
          if (e.target && (e.target.id === 'openLogin' || e.target.id === 'openLoginMobile')) {
            openModal('loginModal');
          } else if (e.target && (e.target.id === 'openRegister' || e.target.id === 'openRegisterMobile')) {
            openModal('registerModal');
          }
        });
        window.__authDelegationBound = true;
      }
    }
    
    // Add real-time validation
    function addRealTimeValidation() {
      // Email validation
      const emailInputs = document.querySelectorAll('input[type="email"]');
      emailInputs.forEach(input => {
        input.addEventListener('blur', function() {
          if (this.value && !validateEmail(this.value)) {
            this.style.borderColor = '#ef4444';
            showTooltip(this, 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­');
          } else {
            this.style.borderColor = 'rgba(255, 255, 255, 0.2)';
            hideTooltip(this);
          }
        });
      });
      
      // Password validation
      const passwordInputs = document.querySelectorAll('input[type="password"]');
      passwordInputs.forEach(input => {
        input.addEventListener('input', function() {
          if (this.value && !validatePassword(this.value)) {
            this.style.borderColor = '#ef4444';
          } else if (this.value) {
            this.style.borderColor = '#10b981';
          }
        });
      });
      
      // Full name validation
      const fullNameInput = document.getElementById('fullName');
      const fullNameIndicator = document.getElementById('fullNameIndicator');
      const nameCount = document.getElementById('nameCount');
      
      if (fullNameInput) {
        fullNameInput.addEventListener('input', function() {
          const value = this.value;
          
          // Update character count
          if (nameCount) {
            nameCount.textContent = `${value.length}/100 Ø­Ø±Ù`;
            if (fullNameIndicator) {
              fullNameIndicator.classList.remove('hidden');
            }
          }
          
          if (value.length > 0) {
            if (value.length < 10) {
              this.style.borderColor = '#ef4444';
              if (nameCount) nameCount.className = 'text-red-400';
              showTooltip(this, `Ø§Ù„Ø§Ø³Ù… Ù‚ØµÙŠØ± Ø¬Ø¯Ø§Ù‹ (${value.length}/10 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)`);
            } else if (value.length > 100) {
              this.style.borderColor = '#ef4444';
              if (nameCount) nameCount.className = 'text-red-400';
              showTooltip(this, `Ø§Ù„Ø§Ø³Ù… Ø·ÙˆÙŠÙ„ Ø¬Ø¯Ø§Ù‹ (${value.length}/100 Ø­Ø±Ù ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰)`);
            } else if (!validateFullName(value)) {
              this.style.borderColor = '#ef4444';
              if (nameCount) nameCount.className = 'text-yellow-400';
              showTooltip(this, 'ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ 3 Ø£Ø³Ù…Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù…ÙØµÙˆÙ„Ø© Ø¨Ù…Ø³Ø§ÙØ§Øª');
            } else {
              this.style.borderColor = '#10b981';
              if (nameCount) nameCount.className = 'text-green-400';
              hideTooltip(this);
            }
          } else {
            if (fullNameIndicator) {
              fullNameIndicator.classList.add('hidden');
            }
          }
        });
        
        fullNameInput.addEventListener('blur', function() {
          if (this.value && !validateFullName(this.value)) {
            this.style.borderColor = '#ef4444';
          }
        });
      }
    }
    
    function showTooltip(element, message) {
      hideTooltip(element); // Remove existing tooltip
      const tooltip = document.createElement('div');
      tooltip.className = 'validation-tooltip';
      tooltip.textContent = message;
      tooltip.style.cssText = `
        position: absolute;
        bottom: -30px;
        right: 0;
        background: #ef4444;
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        white-space: nowrap;
        z-index: 1000;
      `;
      element.style.position = 'relative';
      element.parentElement.appendChild(tooltip);
    }
    
    function hideTooltip(element) {
      const tooltip = element.parentElement.querySelector('.validation-tooltip');
      if (tooltip) {
        tooltip.remove();
      }
    }

    // Setup event listeners
    function setupEventListeners() {
      // Add real-time validation
      addRealTimeValidation();
      
      // Registration form
      const signupForm = document.getElementById('signupForm');
      if (signupForm) {
        console.log('Adding event listener to signup form');
        signupForm.addEventListener('submit', async (e) => {
          console.log('Signup form submitted');
          e.preventDefault();
          const formData = new FormData(e.target);
          await registerUser(formData);
        });
      } else {
        console.error('Signup form not found!');
      }
      
      // Login form
      document.getElementById('loginForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;
        
        await loginUser(email, password);
      });
      
      // OTP form
      document.getElementById('otpForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = localStorage.getItem('userEmail');
        const otp = getOtpValue();
        
        if (otp.length !== 6) {
          showError('otpErrors', 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù…Ø² ÙƒØ§Ù…Ù„Ø§Ù‹ (6 Ø£Ø±Ù‚Ø§Ù…)');
          return;
        }
        
        await verifyOTP(email, otp);
      });
      
      // Forgot password form
      document.getElementById('forgotPasswordForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('forgotEmail').value;
        await requestPasswordReset(email);
      });
      
      // Reset password form
      document.getElementById('resetPasswordForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const newPassword = document.getElementById('newPassword').value;
        const confirmPassword = document.getElementById('confirmNewPassword').value;
        
        if (newPassword !== confirmPassword) {
          showError('resetPasswordErrors', 'ÙƒÙ„Ù…ØªØ§ Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚ØªØ§Ù†');
          return;
        }
        
        if (newPassword.length < 8) {
          showError('resetPasswordErrors', 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
          return;
        }
        
        await resetPassword(newPassword);
      });
      
  // Modal buttons (Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù„Ùˆ ØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„)
  const btnLogin = document.getElementById('openLogin');
  const btnRegister = document.getElementById('openRegister');
  const btnLoginMob = document.getElementById('openLoginMobile');
  const btnRegisterMob = document.getElementById('openRegisterMobile');

  if (btnLogin) btnLogin.onclick = () => openModal('loginModal');
  if (btnRegister) btnRegister.onclick = () => openModal('registerModal');
  if (btnLoginMob) btnLoginMob.onclick = () => openModal('loginModal');
  if (btnRegisterMob) btnRegisterMob.onclick = () => openModal('registerModal');
      
      // Course card handlers
      addCourseCardHandlers();
      
      // Close modals when clicking outside
      document.addEventListener('click', function(e) {
        if (e.target.classList.contains('modal')) {
          const modalId = e.target.id;
          closeModal(modalId);
        }
      });
    }

    // Open/close modals
    function openModal(id) {
      const modal = document.getElementById(id);
      modal.style.display = 'flex';
      setTimeout(() => modal.classList.add('show'), 10);
    }
    
    function closeModal(id) {
      const modal = document.getElementById(id);
      modal.classList.remove('show');
      setTimeout(() => modal.style.display = 'none', 300);
    }

    // ============= Page Protection & Navigation =============
    
    // Check if user has access to specific grade
    function hasGradeAccess(gradeKey) {
      const user = getCurrentUser();
      if (!user) return false;
      
      // Instructors and admins can access all grades
      if (user.role === 'instructor' || user.role === 'admin') {
        return true;
      }

      // Normalize Arabic or stored grade values to internal codes
      function normalizeGrade(g) {
        if (!g || typeof g !== 'string') return g;
        const s = g.trim().toLowerCase();
        const map = {
          // Internal codes pass-through
          'grade1': 'grade1',
          'grade2': 'grade2',
          'grade2sci': 'grade2sci',
          'grade2art': 'grade2art',
          'grade3': 'grade3',
          'grade3sci': 'grade3sci',
          'grade3art': 'grade3art',
          // Arabic variants
          'Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ': 'grade1',
          'Ø§Ù„ØµÙ Ø§Ù„Ø§ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ': 'grade1',
          'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ': 'grade2',
          'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø¹Ù„Ù…ÙŠ': 'grade2sci',
            'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ - Ø¹Ù„Ù…ÙŠ': 'grade2sci',
          'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø§Ø¯Ø¨ÙŠ': 'grade2art',
            'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ - Ø£Ø¯Ø¨ÙŠ': 'grade2art',
          'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ': 'grade3',
          'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø¹Ù„Ù…ÙŠ': 'grade3sci',
            'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« - Ø¹Ù„Ù…ÙŠ': 'grade3sci',
          'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ Ø§Ø¯Ø¨ÙŠ': 'grade3art',
            'Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« - Ø£Ø¯Ø¨ÙŠ': 'grade3art'
        };
        return map[s] || g; // fallback: return original
      }

      const userNormalized = normalizeGrade(user.grade);

      // Exact match (student picked specific track)
      if (userNormalized === gradeKey) return true;

      // If student has generic grade (without specialization) allow both tracks of that grade
      if (userNormalized === 'grade2' && (gradeKey === 'grade2sci' || gradeKey === 'grade2art')) return true;
      if (userNormalized === 'grade3' && (gradeKey === 'grade3sci' || gradeKey === 'grade3art')) return true;

      // Allow mapping from specialization back to generic if needed
      if ((userNormalized === 'grade2sci' || userNormalized === 'grade2art') && gradeKey === 'grade2') return true;
      if ((userNormalized === 'grade3sci' || userNormalized === 'grade3art') && gradeKey === 'grade3') return true;

      return false; // No access
    }
    
    // Redirect functions for authenticated users
    function redirectToGrade(grade) {
      // Check if user is logged in first
      if (!isLoggedIn()) {
        showNotification('ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©', 'error');
        
        // Open login modal automatically
        setTimeout(() => {
          openModal('loginModal');
        }, 500);
        
        console.log('User not logged in, opening login modal for grade:', grade);
        return;
      }
      
      const user = getCurrentUser();
      const gradeNames = {
        "grade1": "Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ",
        "grade2": "Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ (Ø¹Ø§Ù…)",
        "grade2sci": "Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ - Ø¹Ù„Ù…ÙŠ",
        "grade2art": "Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ - Ø£Ø¯Ø¨ÙŠ", 
        "grade3": "Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ (Ø¹Ø§Ù…)",
        "grade3sci": "Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ - Ø¹Ù„Ù…ÙŠ",
        "grade3art": "Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ - Ø£Ø¯Ø¨ÙŠ"
      };
      
      // Check if user has access to this grade
      if (!hasGradeAccess(grade)) {
        const gradeName = gradeNames[grade] || grade;
        if (user.role === 'student') {
          showNotification(`Ø¹Ø°Ø±Ø§Ù‹ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ÙˆØµÙˆÙ„ ÙÙ‚Ø· Ù„ØµÙØ­Ùƒ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ`, 'error');
        } else {
          showNotification(`Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ ${gradeName}`, 'error');
        }
        return;
      }
      
      // Map grade keys to actual page files
      const pages = {
        "grade1": "grade1.html",
        "grade2sci": "grade2_1.html", 
        "grade2art": "grade2_2.html",
        "grade3sci": "grade3_1.html",
        "grade3art": "grade3_2.html"
      };
      
      if (pages[grade]) {
        console.log(`Redirecting ${user.role} to ${pages[grade]} for grade: ${grade}`);
        window.location.href = pages[grade];
      } else {
        showNotification('Ø§Ù„ØµÙØ­Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©', 'error');
      }
    }
    
    // Update course card visibility based on user access
    function updateCourseVisibility() {
      const courseCards = document.querySelectorAll('.course-card');
      const grades = [
        'grade1',      // Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ
        'grade2sci',   // Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ - Ø¹Ù„Ù…ÙŠ  
        'grade2art',   // Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ - Ø£Ø¯Ø¨ÙŠ
        'grade3sci',   // Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ (Ø¹Ù„Ù…ÙŠ)
        'grade3art'    // Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ (Ø£Ø¯Ø¨ÙŠ)
      ];
      
      courseCards.forEach((card, index) => {
        const grade = grades[index];
        if (grade) {
          const hasAccess = hasGradeAccess(grade);
          
          // Remove any existing badges first
          const existingBadge = card.querySelector('.no-access-badge');
          if (existingBadge) {
            existingBadge.remove();
          }
          
          const user = getCurrentUser();
          
          if (hasAccess) {
            card.classList.remove('opacity-50', 'cursor-not-allowed');
            card.classList.add('cursor-pointer');
          } else {
            card.classList.add('opacity-50', 'cursor-not-allowed');
            card.classList.remove('cursor-pointer');
            
            // Add appropriate badge based on user status
            const badge = document.createElement('div');
            badge.className = 'no-access-badge absolute top-2 right-2 text-white text-xs px-2 py-1 rounded';
            card.style.position = 'relative';
            
            if (!user) {
              // User not logged in
              badge.className += ' bg-orange-500';
              badge.textContent = 'ï¿½ ÙŠØªØ·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„';
            } else if (user.role === 'student') {
              // Student without access
              badge.className += ' bg-red-500';
              badge.textContent = 'ğŸ”’ ØºÙŠØ± Ù…ØªØ§Ø­';
            }
            
            card.appendChild(badge);
          }
        }
      });
    }

    // Add course card click handlers
    function addCourseCardHandlers() {
      const courseCards = document.querySelectorAll('.course-card');
      courseCards.forEach((card, index) => {
        card.addEventListener('click', function() {
          // Map each course card to its corresponding grade
          const grades = [
            'grade1',      // Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ
            'grade2sci',   // Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ - Ø¹Ù„Ù…ÙŠ  
            'grade2art',   // Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ - Ø£Ø¯Ø¨ÙŠ
            'grade3sci',   // Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ (Ø¹Ù„Ù…ÙŠ)
            'grade3art'    // Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ (Ø£Ø¯Ø¨ÙŠ)
          ];
          
          if (grades[index]) {
            redirectToGrade(grades[index]);
          }
        });
      });
    }
    
    // Create protected API request function
    async function protectedRequest(url, options = {}) {
      const token = getAuthToken();
      if (!token) {
        logoutUser();
        throw new Error('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ù…Ø² Ù…ØµØ§Ø¯Ù‚Ø©');
      }
      
      const headers = {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${token}`,
        ...options.headers
      };
      
      try {
        const response = await fetch(url, {
          ...options,
          headers
        });
        
        if (response.status === 401) {
          logoutUser();
          throw new Error('Ø§Ù†ØªÙ‡Øª ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¬Ù„Ø³Ø©. ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰');
        }
        
        if (response.status === 403) {
          const result = await response.json();
          if (result.requiresVerification) {
            openOtpModal(getCurrentUser().email);
            throw new Error('ÙŠØ¬Ø¨ ØªÙØ¹ÙŠÙ„ Ø­Ø³Ø§Ø¨Ùƒ Ø£ÙˆÙ„Ø§Ù‹');
          }
        }
        
        return response;
      } catch (error) {
        if (error.message.includes('NetworkError') || error.message.includes('fetch')) {
          throw new Error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª');
        }
        throw error;
      }
    }

    // Mobile menu
    const menuToggle = document.getElementById("menuToggle");
    const mobileMenu = document.getElementById("mobileMenu");
    menuToggle.addEventListener("click", () => {
      mobileMenu.classList.toggle("hidden");
    });
  </script>
  
  <!-- Teacher Mode Auto System -->
  <script src="../js/teacher-mode.js"></script>
</body>
</html>